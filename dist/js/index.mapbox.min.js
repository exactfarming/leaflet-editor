!function(e){var t={};function i(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=30)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.intersectionIcon=t.hoverIcon=t.middleIcon=t.dragIcon=t.icon=t.firstIcon=void 0;var o,n=i(2),r=(o=n)&&o.__esModule?o:{default:o};var s=1;navigator.userAgent.toLowerCase();r.default.isMobileBrowser()&&(s=2);t.firstIcon=L.divIcon({className:"m-editor-div-icon-first",iconSize:[10*s,10*s]});var a=t.icon=L.divIcon({className:"m-editor-div-icon",iconSize:[10*s,10*s]});t.dragIcon=L.divIcon({className:"m-editor-div-icon-drag",iconSize:[10*s*3,10*s*3]}),t.middleIcon=L.divIcon({className:"m-editor-middle-div-icon",iconSize:[10*s,10*s]}),t.hoverIcon=a||L.divIcon({className:"m-editor-div-icon",iconSize:[14*s,14*s]}),t.intersectionIcon=L.divIcon({className:"m-editor-intersection-div-icon",iconSize:[14*s,14*s]})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=L.Control.extend({options:{position:"topleft",btns:[],eventName:"controlAdded",pressEventName:"btnPressed"},_btn:null,stopEvent:L.DomEvent.stopPropagation,initialize:function(e){L.Util.setOptions(this,e)},_titleContainer:null,onAdd:function(e){var t=this;e.on(this.options.pressEventName,function(){t._btn&&!L.DomUtil.hasClass(t._btn,"disabled")&&t._onPressBtn()});var i=L.DomUtil.create("div","leaflet-bar leaflet-editor-buttons");e._controlContainer.appendChild(i);var o=this.options,n=this;return setTimeout(function(){n._setBtn(o.btns,i),o.eventName&&e.fire(o.eventName,{control:n}),L.DomEvent.addListener(n._btn,"mouseover",t._onMouseOver,t),L.DomEvent.addListener(n._btn,"mouseout",t._onMouseOut,t)},1e3),e.getBtnControl=function(){return t},i},_onPressBtn:function(){},_onMouseOver:function(){},_onMouseOut:function(){},_setBtn:function(e,t){var i,o=this;e.forEach(function(n,r){r===e.length-1&&(n.className+=" last");var s=document.createElement("div");t.appendChild(s);var a=L.DomUtil.create("a","leaflet-btn",s);a.href="#";var l=L.DomEvent.stopPropagation;L.DomEvent.on(a,"click",l).on(a,"mousedown",l).on(a,"dblclick",l).on(a,"click",L.DomEvent.preventDefault),a.appendChild(L.DomUtil.create("i","fa"+(n.className?" "+n.className:"")));var d,c,u=(d=o._map,c=n.pressEventName||o.options.pressEventName,function(){d.fire(c)});L.DomEvent.on(a,"click",L.DomEvent.stopPropagation).on(a,"click",u),i=a}),this._btn=i},getBtnContainer:function(){return this._map._controlCorners.topleft},getBtnAt:function(e){return this.getBtnContainer().child[e]},disableBtn:function(e){L.DomUtil.addClass(this.getBtnAt(e),"disabled")},enableBtn:function(e){L.DomUtil.removeClass(this.getBtnAt(e),"disabled")}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={isMobileBrowser:function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(i(13));n(i(4));function n(e){return e&&e.__esModule?e:{default:e}}t.default=L.EditPloygon=o.default.extend({_oldE:void 0,_k:1,_holes:[],initialize:function(e,t){L.Polyline.prototype.initialize.call(this,e,t),this._initWithHoles(e),this.options.className="leaflet-clickable polygon"},_update:function(e){var t=e.marker;if(t._mGroup._isHole){var i=t._mGroup._markers;i=i.filter(function(e){return!e.isMiddle()}),this._holes[t._mGroup.position]=i.map(function(e){return e.getLatLng()})}this.redraw()},_removeHole:function(e){var t=e.marker._mGroup.position;this._holes.splice(t,1),this._map.getEHMarkersGroup().removeLayer(e.marker._mGroup._leaflet_id),this._map.getEHMarkersGroup().repos(e.marker._mGroup.position),this.redraw()},onAdd:function(e){var t=this;L.Polyline.prototype.onAdd.call(this,e),e.off("editor:add_marker"),e.on("editor:add_marker",function(e){return t._update(e)}),e.off("editor:drag_marker"),e.on("editor:drag_marker",function(e){return t._update(e)}),e.off("editor:delete_marker"),e.on("editor:delete_marker",function(e){return t._update(e)}),e.off("editor:delete_hole"),e.on("editor:delete_hole",function(e){return t._removeHole(e)}),this.on("mousemove",function(t){e.fire("editor:edit_polygon_mousemove",{layerPoint:t.layerPoint})}),this.on("mouseout",function(){return e.fire("editor:edit_polygon_mouseout")})},onRemove:function(e){this.off("mousemove"),this.off("mouseout"),e.off("editor:edit_polygon_mouseover"),e.off("editor:edit_polygon_mouseout"),L.Polyline.prototype.onRemove.call(this,e)},addHole:function(e){this._holes=this._holes||[],this._holes.push(e),this.redraw()},hasHoles:function(){return this._holes.length>0},_resetLastHole:function(){this._map.getSelectedMarker().removeHole(),this._k>.001&&this._addHole(this._oldE,.5)},checkHoleIntersection:function(){var e=this._map;if(!e.options.allowIntersection&&!e.getEMarkersGroup().isEmpty())for(var t=this._map.getEHMarkersGroup().getLayers(),i=t[t.length-1],o=t[t.length-1].getLayers(),n=0;n<o.length;n++){var r=o[n];if(r._detectIntersectionWithHoles()){this._resetLastHole();break}if(r._isOutsideOfPolygon(this._map.getEMarkersGroup())){this._resetLastHole();break}for(var s=0;s<t.length;s++){var a=t[s];if(i!==a&&a._isMarkerInPolygon(r.getLatLng())){this._resetLastHole();break}}}}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=L.Class.extend({_time:2e3,initialize:function(e,t,i){this._map=e,this._popupPane=e._panes.popupPane,this._text=t,this._isStatic=!1,this._container=L.DomUtil.create("div","leaflet-tooltip",this._popupPane),this._render(),this._time=i||this._time},dispose:function(){this._container&&(this._popupPane.removeChild(this._container),this._container=null)},static:function(e){return this._isStatic=e||this._isStatic,this},_render:function(){this._container.innerHTML="<span>"+this._text+"</span>"},_updatePosition:function(e){var t=this._map.latLngToLayerPoint(e),i=this._container;return this._container&&(i.style.visibility="inherit",L.DomUtil.setPosition(i,t)),this},_showError:function(e){return this._container&&(L.DomUtil.addClass(this._container,"leaflet-show"),L.DomUtil.addClass(this._container,"leaflet-error-tooltip")),this._updatePosition(e),this._isStatic||this._map.on("mousemove",this._onMouseMove,this),this},_showInfo:function(e){return this._container&&(L.DomUtil.addClass(this._container,"leaflet-show"),L.DomUtil.addClass(this._container,"leaflet-info-tooltip")),this._updatePosition(e),this._isStatic||this._map.on("mousemove",this._onMouseMove,this),this},_hide:function(){return this._container&&(L.DomUtil.removeClass(this._container,"leaflet-show"),L.DomUtil.removeClass(this._container,"leaflet-info-tooltip"),L.DomUtil.removeClass(this._container,"leaflet-error-tooltip")),this._map.off("mousemove",this._onMouseMove,this),this},text:function(e){this._text=e||this._text,this._render()},show:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";this.text(),"error"===t&&this.showError(e),"info"===t&&this.showInfo(e)},showInfo:function(e){this._showInfo(e),this._hideInfoTimeout&&(clearTimeout(this._hideInfoTimeout),this._hideInfoTimeout=null),this._hideInfoTimeout=setTimeout(L.Util.bind(this.hide,this),this._time)},showError:function(e){this._showError(e),this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null),this._hideErrorTimeout=setTimeout(L.Util.bind(this.hide,this),this._time)},hide:function(){this._hide()},_onMouseMove:function(e){this._updatePosition(e.latlng)},setTime:function(e){e&&(this._time=e)}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=L.FeatureGroup.extend({update:function(){var e=this._map;e._convertToEdit(e.getEMarkersGroup()),e.getEMarkersGroup()._connectMarkers()}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=i(7),r=(o=n)&&o.__esModule?o:{default:o};t.default=L.Polyline.extend({options:r.default.style.drawLine,_latlngToMove:void 0,onAdd:function(e){L.Polyline.prototype.onAdd.call(this,e),this.setStyle(e.options.style.drawLine)},addLatLng:function(e){return this._latlngToMove&&(this._latlngToMove=void 0),this._latlngs.length>1&&this._latlngs.splice(-1),this._latlngs.push(L.latLng(e)),this.redraw()},update:function(e){return!this._latlngToMove&&this._latlngs.length&&(this._latlngToMove=L.latLng(e),this._latlngs.push(this._latlngToMove)),this._latlngToMove&&(this._latlngToMove.lat=e.lat,this._latlngToMove.lng=e.lng,this.redraw()),this},_addLine:function(e,t,i){i||e.addTo(t)},clear:function(){this.setLatLngs([])}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={allowIntersection:!1,allowCorrectIntersection:!1,forceToDraw:!0,translations:{removePolygon:"remove polygon",removePoint:"remove point"},overlays:{},defaultControlLayers:!0,style:{view:{opacity:.5,fillOpacity:.2,dashArray:null,clickable:!1,fill:!0,stroke:!0,color:"#00FFFF",weight:3},draw:{opacity:.5,fillOpacity:.2,dashArray:"5, 10",clickable:!0,fill:!0,stroke:!0,color:"#00F800",weight:3},startDraw:{},drawLine:{opacity:.7,fill:!1,fillColor:"#00F800",color:"#00F800",weight:3,dashArray:"5, 10",stroke:!0,clickable:!1}},markerIcon:void 0,markerHoverIcon:void 0,errorLineStyle:{color:"red",weight:3,opacity:1,smoothFactor:1},previewErrorLineStyle:{color:"red",weight:3,opacity:1,smoothFactor:1,dashArray:"5, 10"},text:{intersection:"Self-intersection is prohibited",deletePointIntersection:"Deletion of point is not possible. Self-intersection is prohibited",removePolygon:"Remove polygon",clickToEdit:"click to edit",clickToAddNewEdges:"<div>click&nbsp;&nbsp;<div class='m-editor-middle-div-icon static group-selected'></div>&nbsp;&nbsp;to add new edges</div>",clickToDrawInnerEdges:"click to draw inner edges",clickToJoinEdges:"click to join edges",clickToRemoveAllSelectedEdges:"<div>click&nbsp;&nbsp;&nbsp;&nbsp;<div class='m-editor-div-icon static group-selected'></div>&nbsp;&nbsp;to remove edge&nbsp;&nbsp;or<br>click&nbsp;&nbsp;<i class='fa fa-trash'></i>&nbsp;&nbsp;to remove all selected edges</div>",clickToSelectEdges:"<div>click&nbsp;&nbsp;&nbsp;&nbsp;<div class='m-editor-div-icon static'></div>&nbsp;/&nbsp;<div class='m-editor-middle-div-icon static'></div>&nbsp;&nbsp;to select edges</div>",dblclickToJoinEdges:"double click to join edges",clickToStartDrawPolygonOnMap:"click to start draw polygon on map",deleteSelectedEdges:"deleted selected edges",rejectChanges:"reject changes",jsonWasLoaded:"JSON was loaded",checkJson:"check JSON",loadJson:"load GeoJSON",forgetToSave:"Save changes by pressing outside of polygon",searchLocation:"Search location",submitLoadBtn:"submit",zoom:"Zoom",hideFullScreen:"Hide full screen",showFullScreen:"Show full screen"},worldCopyJump:!0,geoJSONArea:null}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=i(4),r=((o=n)&&o.__esModule,i(0));var s=navigator.userAgent.toLowerCase();-1===s.indexOf("ipad")&&s.indexOf("iphone");var a=!1,l=null;t.default=L.Marker.extend({_draggable:void 0,_oldLatLngState:void 0,initialize:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i=$.extend({icon:r.icon,draggable:!1},i),L.Marker.prototype.initialize.call(this,t,i),this._mGroup=e,this._isFirst=0===e.getLayers().length},removeGroup:function(){this._mGroup._isHole?this._mGroup.removeHole():this._mGroup.remove()},remove:function(){this._map&&this._mGroup.removeSelected()},removeHole:function(){this.removeGroup()},next:function(){var e=this._next._next;return this._next.isMiddle()||(e=this._next),e},prev:function(){var e=this._prev._prev;return this._prev.isMiddle()||(e=this._prev),e},changePrevNextPos:function(){if(this._prev.isMiddle()){var e=this._mGroup._getMiddleLatLng(this.prev(),this),t=this._mGroup._getMiddleLatLng(this,this.next());this._prev.setLatLng(e),this._next.setLatLng(t)}},resetEvents:function(e){e&&e.call(this)},_posHash:function(){return this._prev.position+"_"+this.position+"_"+this._next.position},_resetIcon:function(e){if(!this._hasFirstIcon()){var t=e||r.icon;this.setIcon(t),this.prev().setIcon(t),this.next().setIcon(t)}},_setHoverIcon:function(e){this._hasFirstIcon()||this.setIcon(e||r.hoverIcon)},_addIconClass:function(e){L.DomUtil.addClass(this._icon,e)},_removeIconClass:function(e){L.DomUtil.removeClass(this._icon,e)},_setIntersectionIcon:function(){var e=r.intersectionIcon.options.className,t="m-editor-div-icon";this._removeIconClass(t),this._addIconClass(e),this._prevIntersected=this.prev(),this._prevIntersected._removeIconClass(t),this._prevIntersected._addIconClass(e),this._nextIntersected=this.next(),this._nextIntersected._removeIconClass(t),this._nextIntersected._addIconClass(e)},_setFirstIcon:function(){this._isFirst=!0,this.setIcon(r.firstIcon)},_hasFirstIcon:function(){return this._icon&&L.DomUtil.hasClass(this._icon,"m-editor-div-icon-first")},_setMiddleIcon:function(){this.setIcon(r.middleIcon)},isMiddle:function(){return this._icon&&L.DomUtil.hasClass(this._icon,"m-editor-middle-div-icon")&&!L.DomUtil.hasClass(this._icon,"leaflet-drag-target")},_setDragIcon:function(){this._removeIconClass("m-editor-div-icon"),this.setIcon(r.dragIcon)},isPlain:function(){return L.DomUtil.hasClass(this._icon,"m-editor-div-icon")||L.DomUtil.hasClass(this._icon,"m-editor-intersection-div-icon")},_onceClick:function(){var e=this;this._isFirst&&this.once("click",function(t){if(e._hasFirstIcon()){var i=e._map,o=e._mGroup;if(o._markers.length<3)e._onceClick();else{var n=t.target._latlng;e._map._storedLayerPoint=t.target,o.hasIntersection(n)?e._onceClick():(e._isFirst=!1,e.setIcon(r.icon),i.fire("editor:__join_path",{mGroup:o}))}}})},_detectGroupDelete:function(){var e=this._map,t=e.getSelectedMGroup();if(this._mGroup._isHole||!this.isPlain()||t&&t.hasFirstMarker())return!1;if(!this.isSelectedInGroup())return l=null,!1;if(l&&this._leaflet_id===l._leaflet_id&&(this._latlng.lat!==l._latlng.lat||this._latlng.lng!==l._latlng.lng))return!1;if(e.options.notifyClickMarkerDeletePolygon&&(t&&!t._isHole&&3===t.getLayers().filter(function(e){return $(e._icon).hasClass("m-editor-div-icon")}).length)){if(l!==this)return l=this,!0;l=null}return!1},isAcceptedToDelete:function(){return l===this&&this.isSelectedInGroup()},_bindCommonEvents:function(){var e=this;this.on("click",function(t){var i=e._map;if(e._detectGroupDelete())i.msgHelper.msg(i.options.text.acceptDeletion,"error",e);else{e._map._storedLayerPoint=t.target;var o=e._mGroup;if(!o.hasFirstMarker()||e===o.getFirst())if(e._hasFirstIcon()&&e._mGroup.hasIntersection(e.getLatLng(),!0))i.edgesIntersected(!1);else if(o.setSelected(e),!e._hasFirstIcon()&&!o.getFirst()._hasFirstIcon()){if(!e.isSelectedInGroup())return o.select(),void(e.isMiddle()?i.msgHelper.msg(i.options.text.clickToAddNewEdges,null,e):i.msgHelper.msg(i.options.text.clickToRemoveAllSelectedEdges,null,e));if(e.isMiddle())o.setMiddleMarkers(e.position),e._resetIcon(r.icon),o.select(),i.msgHelper.msg(i.options.text.clickToRemoveAllSelectedEdges,null,e),l=null;else if(!o.getFirst()._hasFirstIcon()&&!a){if(i.msgHelper.hide(),e._detectIntersection({target:{_latlng:o._getMiddleLatLng(e.prev(),e.next())}}))return e.resetStyle(),i._showIntersectionError(i.options.text.deletePointIntersection),void e._previewErrorLine();var n=e.getLatLng(),s=e.next();if(o.removeMarker(e),o.isEmpty())o._isHole?i.fire("editor:polygon:hole_deleted"):i.fire("editor:polygon:deleted"),i.msgHelper.hide();else{var d=s._prev.getLatLng();d.lat===n.lat&&d.lng===n.lng&&i.msgHelper.msg(i.options.text.clickToAddNewEdges,null,s._prev),o.setSelected(s)}o.select()}}}}),this.on("mouseover",function(){var t=e._map;e._mGroup.getFirst()._hasFirstIcon()?e._mGroup.getLayers().length>2&&(e._hasFirstIcon()?t.fire("editor:first_marker_mouseover",{marker:e}):e===e._mGroup._lastMarker&&t.fire("editor:last_marker_dblclick_mouseover",{marker:e})):e.isSelectedInGroup()?e.isMiddle()?t.fire("editor:selected_middle_marker_mouseover",{marker:e}):t.fire("editor:selected_marker_mouseover",{marker:e}):t.fire("editor:not_selected_marker_mouseover",{marker:e}),e.isAcceptedToDelete()&&t.msgHelper.msg(t.options.text.acceptDeletion,"error",e)}),this.on("mouseout",function(){e._map.fire("editor:marker_mouseout")}),this._onceClick(),this.on("dblclick",function(){var t=e._mGroup;t&&t.getFirst()&&t.getFirst()._hasFirstIcon()&&e===t._lastMarker&&t.getFirst().fire("click")}),this.on("drag",function(t){t.target.changePrevNextPos();var i=e._map;i._convertToEdit(i.getEMarkersGroup()),e._setDragIcon(),i.fire("editor:drag_marker",{marker:e})}),this.on("dragend",function(){e._mGroup.select(),e._map.fire("editor:dragend_marker",{marker:e}),a=!0,setTimeout(function(){a=!1},200),e._map.fire("editor:selected_marker_mouseover",{marker:e})})},_isInsideHole:function(){for(var e=this._map.getEHMarkersGroup().getLayers(),t=0;t<e.length;t++){var i=e[t];if(this._mGroup!==i&&i._isMarkerInPolygon(this.getLatLng()))return!0}return!1},_isOutsideOfPolygon:function(e){return!e._isMarkerInPolygon(this.getLatLng())},_detectIntersection:function(e){var t=this._map;if(!t.options.allowIntersection){var i=void 0===e?this.getLatLng():e.target._latlng,o=!1,n=!1;this._mGroup._isHole?(o=this._isOutsideOfPolygon(t.getEMarkersGroup()),n=this._isInsideHole()):n=this._isInsideHole();var r=n||o||this._mGroup.hasIntersection(i)||this._detectIntersectionWithHoles(e);return t.edgesIntersected(r),r&&this._map._showIntersectionError(),t.edgesIntersected()}},_detectIntersectionWithHoles:function(e){var t,i=this,o=this._map,n=!1,r=void 0===e?this.getLatLng():e.target._latlng,s=o.getEHMarkersGroup().getLayers(),a=o.getEMarkersGroup(),l=this.prev(),d=this.next();if(null!=l||null!=d){var c,u=l.getLatLng(),h=d.getLatLng(),_=[];if(this._mGroup._isHole){for(var p=0;p<s.length;p++)if((t=s[p])!==this._mGroup){if(n=this._mGroup.hasIntersectionWithHole([r,u,h],t))return n;if(_=[],(c=t.getLayers())._each(function(e){i._mGroup._isMarkerInPolygon(e.getLatLng())&&_.push("")}),_.length===c.length)return!0}return this._mGroup.hasIntersectionWithHole([r,u,h],a)}for(p=0;p<s.length;p++){if(n=this._mGroup.hasIntersectionWithHole([r,u,h],s[p]))return n;_=[],c=s[p].getLayers();for(var m=0;m<c.length;m++)c[m]._isOutsideOfPolygon(a)&&_.push("");if(_.length===c.length)return!0}return n}},onAdd:function(e){var t=this;L.Marker.prototype.onAdd.call(this,e),this.on("dragstart",function(e){t._storedLayerPoint=null,t._mGroup.setSelected(t),t._oldLatLngState=e.target._latlng,t._prev.isPlain()&&t._mGroup.setMiddleMarkers(t.position)}).on("drag",function(e){t._onDrag(e)}).on("dragend",function(e){t._onDragEnd(e)}),this.on("mousedown",function(){if(!t.dragging._enabled)return!1}),this._bindCommonEvents(e)},_onDrag:function(e){this._detectIntersection(e)},_onDragEnd:function(e){this._detectIntersection(e)&&!this._map.options.allowCorrectIntersection&&this._restoreOldPosition()},_restoreOldPosition:function(){var e=this._map;if(e.edgesIntersected()){var t=this._oldLatLngState;this.setLatLng(L.latLng(t.lat,t.lng)),this.changePrevNextPos(),e._convertToEdit(e.getEMarkersGroup()),e.fire("editor:drag_marker",{marker:this}),this._oldLatLngState=void 0,this.resetStyle()}else this._oldLatLngState=this.getLatLng()},_animateZoom:function(e){if(this._map){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(t)}},resetIcon:function(){this._removeIconClass("m-editor-intersection-div-icon"),this._removeIconClass("m-editor-div-icon-drag")},unSelectIconInGroup:function(){this._removeIconClass("group-selected")},_selectIconInGroup:function(){this.isMiddle()||this._addIconClass("m-editor-div-icon"),this._addIconClass("group-selected")},selectIconInGroup:function(){this._prev&&this._prev._selectIconInGroup(),this._selectIconInGroup(),this._next&&this._next._selectIconInGroup()},isSelectedInGroup:function(){return L.DomUtil.hasClass(this._icon,"group-selected")},onRemove:function(e){this.off("mouseout"),L.Marker.prototype.onRemove.call(this,e)},_errorLines:[],_prevErrorLine:null,_nextErrorLine:null,_drawErrorLines:function(){var e=this._map;this._clearErrorLines();var t=this.getLatLng(),i=[this.prev().getLatLng(),t],o=[this.next().getLatLng(),t],n=this._map.options.errorLineStyle;this._prevErrorLine=new L.Polyline(i,n),this._nextErrorLine=new L.Polyline(o,n),this._prevErrorLine.addTo(e),this._nextErrorLine.addTo(e),this._errorLines.push(this._prevErrorLine),this._errorLines.push(this._nextErrorLine)},_clearErrorLines:function(){var e=this;this._errorLines._each(function(t){return e._map.removeLayer(t)})},setIntersectedStyle:function(){this._setIntersectionIcon(),this._drawErrorLines()},resetStyle:function(){this.resetIcon(),this.selectIconInGroup(),this._prevIntersected&&(this._prevIntersected.resetIcon(),this._prevIntersected.selectIconInGroup()),this._nextIntersected&&(this._nextIntersected.resetIcon(),this._nextIntersected.selectIconInGroup()),this._prevIntersected=null,this._nextIntersected=null,this._clearErrorLines()},_previewErLine:null,_pt:null,_previewErrorLine:function(){var e=this;this._previewErLine&&this._map.removeLayer(this._previewErLine),this._pt&&clearTimeout(this._pt);var t=[this.next().getLatLng(),this.prev().getLatLng()],i=this._map.options.previewErrorLineStyle;this._previewErLine=new L.Polyline(t,i),this._previewErLine.addTo(this._map),this._pt=setTimeout(function(){e._map.removeLayer(e._previewErLine)},900)}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=t;return i.forEach(function t(n,r){var s=o[n].position;void 0!==s&&(s!==r&&(e=o[n],o[n]=o[i[s]],o[i[s]]=e),s!=r&&t.call(null,n,r))}),o}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a(i(11)),n=a(i(15)),r=a(i(22)),s=a(i(7));function a(e){return e&&e.__esModule?e:{default:e}}i(28),t.default=function(e){var t=this,i=("mapbox"===e?L.mapbox.Map:L.Map).extend(Object.assign(o.default,{$:void 0,initialize:function(t,i){i.text&&(Object.assign(s.default.text,i.text),delete i.text);var o=i.controls;o&&!1===o.zoom&&(i.zoomControl=!1),i.style&&(i.style.draw&&Object.assign(s.default.style.draw,i.style.draw),i.style.view&&Object.assign(s.default.style.view,i.style.view),i.style.startDraw&&Object.assign(s.default.style.startDraw,i.style.startDraw),i.style.drawLine&&Object.assign(s.default.style.drawLine,i.style.drawLine),delete i.style),Object.assign(this.options,s.default,i),"mapbox"===e?L.mapbox.Map.prototype.initialize.call(this,t,this.options.mapboxId,this.options):L.Map.prototype.initialize.call(this,t,this.options),this.$=$(this._container),r.default.setLayers(),this._addLayers([r.default.viewGroup,r.default.editGroup,r.default.editPolygon,r.default.editMarkersGroup,r.default.editLineGroup,r.default.dashedEditLineGroup,r.default.editHoleMarkersGroup]),this._setOverlays(i),this.options.forceToDraw&&this.mode("draw")},_setOverlays:function(e){var t=e.overlays;for(var i in t){var o=t[i];this._controlLayers.addOverlay(o,i),o.addTo(this),o.bringToBack(),o.on("click",function(){return!1}),o.on("mouseup",function(){return!1})}},getVGroup:function(){return r.default.viewGroup},getEGroup:function(){return r.default.editGroup},getEPolygon:function(){return r.default.editPolygon},getEMarkersGroup:function(){return r.default.editMarkersGroup},getELineGroup:function(){return r.default.editLineGroup},getDELine:function(){return r.default.dashedEditLineGroup},getEHMarkersGroup:function(){return r.default.editHoleMarkersGroup},getSelectedPolygon:function(){return t._selectedPolygon},getSelectedMGroup:function(){return this._selectedMGroup}}));return i.addInitHook(n.default),i}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s(i(12)),n=s(i(3)),r=i(14);function s(e){return e&&e.__esModule?e:{default:e}}t.default=Object.assign({_selectedMarker:void 0,_selectedVLayer:void 0,_oldSelectedMarker:void 0,__polygonEdgesIntersected:!1,_modeType:"draw",_controlLayers:void 0,_getSelectedVLayer:function(){return this._selectedVLayer},_setSelectedVLayer:function(e){this._selectedVLayer=e},_clearSelectedVLayer:function(){this._selectedVLayer=void 0},_hideSelectedVLayer:function(e){e.bringToBack(),e&&(this._showSelectedVLayer(this._getSelectedVLayer()),this._setSelectedVLayer(e),e._path.style.visibility="hidden")},_showSelectedVLayer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._selectedVLayer;e&&(e._path.style.visibility="")},hasSelectedVLayer:function(){return void 0!==this._getSelectedVLayer()},_addEGroup_To_VGroup:function(){var e=this.getVGroup();this.getEGroup().eachLayer(function(t){if(!t.isEmpty()){var i=t._holes,o=t.getLatLngs();$.isArray(i)&&i&&(o=[o].concat(i)),e.addLayer(L.polygon(o))}})},_addEPolygon_To_VGroup:function(){var e=this.getVGroup(),t=this.getEPolygon(),i=t.getHoles(),o=t.getLatLngs();o.length<=2||($.isArray(i)&&i&&(o=[o].concat(i)),e.addLayer(L.polygon(o)))},_setEPolygon_To_VGroup:function(){var e=this.getEPolygon(),t=this._getSelectedVLayer();t&&(t._latlngs=e.getLatLngs(),t._holes=e.getHoles(),t.redraw())},_convert_EGroup_To_VGroup:function(){this.getVGroup().clearLayers(),this._addEGroup_To_VGroup()},_convertToEdit:function(e){var t=this;if(e instanceof L.MultiPolygon){var i=this.getEGroup();return i.clearLayers(),e.eachLayer(function(e){var o=e.getLatLngs(),r=e._holes;$.isArray(r)&&(o=[o].concat(r));var s=new n.default(o);s.addTo(t),i.addLayer(s)}),i}if(e instanceof L.MarkerGroup){var o=this.getEPolygon(),r=e.getLayers(),s=(r=r.filter(function(e){return!e.isMiddle()})).map(function(e){return e.getLatLng()}),a=o.getHoles();return a&&(s=[s].concat(a)),o.setLatLngs(s),o.redraw(),o}},_setMode:function(e){var t=this.options;this.getEPolygon().setStyle(t.style[e])},_getModeType:function(){return this._modeType},_setModeType:function(e){this.$.removeClass("map-"+this._modeType),this._modeType=e,this.$.addClass("map-"+this._modeType)},_setMarkersGroupIcon:function(e){var t=this.options.markerIcon,i=this.options.markerHoverIcon,o=this._getModeType();if(t)if(t.mode){var n=t.mode[o];void 0!==n&&(e.options.mIcon=n)}else e.options.mIcon=t;if(i)if(i.mode){var r=i[o];void 0!==r&&(e.options.mHoverIcon=r)}else e.options.mHoverIcon=i;e.options.mHoverIcon=e.options.mHoverIcon||e.options.mIcon,"afterDraw"===o&&e.updateStyle()},mode:function(e){if(this.fire(this._modeType+"_events_disable"),this.fire(e+"_events_enable"),this._setModeType(e),void 0===e)return this._modeType;this._clearEvents(),e=this[e]()||e,this._setMode(e)},isMode:function(e){return e===this._modeType},draw:function(){(this.isMode("edit")||this.isMode("view")||this.isMode("afterDraw"))&&this._clearMap(),this._bindDrawEvents()},cancel:function(){this._clearMap(),this.mode("view")},clear:function(){this._clearEvents(),this._clearMap(),this.fire("editor:map_cleared")},clearAll:function(){this.mode("view"),this.clear(),this.getVGroup().clearLayers()},saveState:function(){_map.getEPolygon().isEmpty()||(this._getSelectedVLayer()?this._setEPolygon_To_VGroup():this._addEPolygon_To_VGroup()),this.clear(),this.mode("draw");var e=this.getVGroup().toGeoJSON();return e.geometry?e.geometry:{}},geoJSONArea:function(e){var t=window.turf&&window.turf.area||this.options.geoJSONArea;return t||console.warn('Warning: Implement "geoJSONArea" function ( leaflet-editor )'),t?t(e):0},area:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).precLatLng,t=void 0===e?2:e,i=this.getVGroup(),o=this.getEPolygon(),n=this._getSelectedVLayer(),s=0;if(!o.isEmpty()){var a=this.geoJSONArea((0,r.precisionGeoJSON)(o.toGeoJSON(),t)),l=this.geoJSONArea((0,r.precisionGeoJSON)(i.toGeoJSON(),t)),d=n?this.geoJSONArea((0,r.precisionGeoJSON)(n.toGeoJSON(),t)):0;this.hasSelectedVLayer()&&a>0&&(l-=d),s=a>0?l+a:l}return(0,r.precision)(s,t)},getSelectedMarker:function(){return this._selectedMarker},clearSelectedMarker:function(){this._selectedMarker=null},removeSelectedMarker:function(){var e=this._selectedMarker,t=e.prev(),i=e.next(),o=e._middlePrev,n=e._middleNext;e.remove(),this._selectedMarker=o,this._selectedMarker.remove(),this._selectedMarker=n,this._selectedMarker.remove(),t._middleNext=null,i._middlePrev=null},removePolygon:function(e){this.getEMarkersGroup().clearLayers(),this.getEHMarkersGroup().clearLayers(),e.clear(),this.isMode("afterDraw")&&this.mode("draw"),this.clearSelectedMarker(),this._setEPolygon_To_VGroup()},createEditPolygon:function(e){var t=L.geoJson(e);this._getSelectedVLayer()?this._setEPolygon_To_VGroup():this._addEPolygon_To_VGroup(),this.clear();var i=t.getLayers()[0];if(i)for(var o=i.getLayers(),n=this.getVGroup(),r=0;r<o.length;r++){var s=o[r];n.addLayer(s)}this.mode("draw"),this._fitVBounds()},moveMarker:function(e){this.getEMarkersGroup().getSelected().setLatLng(e)},_fitVBounds:function(){0!==this.getVGroup().getLayers().length&&this.fitBounds(this.getVGroup().getBounds(),{padding:[30,30]})},_clearMap:function(){this.getEGroup().clearLayers(),this.getEPolygon().clear(),this.getEMarkersGroup().clear();var e=this.getSelectedMGroup();e&&e.getDELine().clear(),this.getEHMarkersGroup().clearLayers(),this._activeEditLayer=void 0,this._showSelectedVLayer(),this._clearSelectedVLayer(),this.clearSelectedMarker()},_clearEvents:function(){this._unBindDrawEvents()},_activeEditLayer:void 0,_setActiveEditLayer:function(e){this._activeEditLayer=e},_getActiveEditLayer:function(){return this._activeEditLayer},_clearActiveEditLayer:function(){this._activeEditLayer=null},_setEHMarkerGroup:function(e){var t=new L.MarkerGroup;t._isHole=!0,this._setMarkersGroupIcon(t);var i=this.getEHMarkersGroup();t.addTo(i);var o=i.getLayers().length-1;t._position=o;for(var n=0;n<e.length;n++)t.setHoleMarker(e[n],void 0,{},{hGroup:o,hMarker:n});var r=t.getLayers();r.map(function(e,i){t._setMiddleMarkers(e,i)});var s=this.getEPolygon();return(r=t.getLayers()).forEach(function(e){s.updateHolePoint(o,e.__position,e._latlng)}),t},_moveEPolygonOnTop:function(){var e=this.getEPolygon();if(e._container){var t=$(e._container.parentNode).children().last(),i=$(e._container);i[0]!==t&&i.detach().insertAfter(t)}},restoreEPolygon:function(e){if(e=e||this.getEPolygon()){var t=e.getLatLngs();this.getEMarkersGroup().setAll(t);var i=e.getHoles();if(i)for(var o=0;o<i.length;o++)this._setEHMarkerGroup(i[o])}},getControlLayers:function(){return(void 0)._controlLayers},edgesIntersected:function(e){if(void 0===e)return this.__polygonEdgesIntersected;this.__polygonEdgesIntersected=e,!0===e?this.fire("editor:intersection_detected",{intersection:!0}):this.fire("editor:intersection_detected",{intersection:!1})},_errorTimeout:null,_showIntersectionError:function(e){var t=this;this._errorTimeout&&clearTimeout(this._errorTimeout),this.msgHelper.msg(e||this.options.text.intersection,"error",this._storedLayerPoint||this.getSelectedMarker()),this._storedLayerPoint=null,this._errorTimeout=setTimeout(function(){t.msgHelper.hide()},1e4)}},o.default)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(0);t.default={_bindDrawEvents:function(){var e=this;this._unBindDrawEvents(),this.on("click",function(t){if(e._storedLayerPoint=t.layerPoint,!(t.originalEvent&&0===t.originalEvent.clientX&&0===t.originalEvent.clientY||t.target instanceof L.Marker)){var i=t.target.getEMarkersGroup();if(i.isEmpty()){e._addMarker(t),e.fire("editor:start_add_new_polygon");var n=e.options.style.startDraw;return n&&e.getEPolygon().setStyle(n),e._clearSelectedVLayer(),e._selectedMGroup=i,!1}var r=i.getFirst();if(r&&r._hasFirstIcon())return t.target instanceof L.Marker||e._addMarker(t),!1;var s=e.getEHMarkersGroup(),a=s.getLastHole();if(r&&!r._hasFirstIcon()&&!(t.target.getEPolygon()._path!==t.originalEvent.target||a&&a.getFirst()&&a.getFirst()._hasFirstIcon())){e.clearSelectedMarker();var l=s.addHoleGroup();return l.set(t.latlng,null,{icon:o.firstIcon}),e._selectedMGroup=l,e.fire("editor:start_add_new_hole"),!1}if(a&&!a.isEmpty()&&a.hasFirstMarker()){if(e.getEMarkersGroup()._isMarkerInPolygon(t.latlng))s.getLastHole().set(t.latlng)._detectIntersection()&&e._showIntersectionError();else e._showIntersectionError();return!1}e._getSelectedVLayer()?e._setEPolygon_To_VGroup():e._addEPolygon_To_VGroup(),e.clear(),e.mode("draw"),e.fire("editor:marker_group_clear")}}),this.on("editor:__join_path",function(t){var i=t.mGroup;if(i){i._isHole&&e.getEHMarkersGroup().resetLastHole();var n=-1;i.getLayers().forEach(function(){var e=i.addMarker(n,null,{icon:o.middleIcon});n=e.position+2}),i.getDELine().clear(),i.getLayers()._each(function(e){e.dragging.enable()}),i.select(),e.getEPolygon().setStyle(e.options.style.draw),i._isHole?e.fire("editor:polygon:hole_created"):e.fire("editor:polygon:created")}});var t=this.getVGroup();t.on("click",function(i){t.onClick(i),e.msgHelper.msg(e.options.text.clickToDrawInnerEdges,null,i.layerPoint),e.fire("editor:polygon:selected")}),this.on("editor:delete_marker",function(){e._convertToEdit(e.getEMarkersGroup())}),this.on("editor:delete_polygon",function(){e.getEHMarkersGroup().remove()})},_addMarker:function(e){var t=e.latlng,i=this.getEMarkersGroup(),o=i.set(t);return this._convertToEdit(i),o},_updateDELine:function(e){return this.getEMarkersGroup().getDELine().update(e)},_unBindDrawEvents:function(){this.off("click"),this.getVGroup().off("click"),this.off("dblclick"),this.getDELine().clear(),this.off("editor:__join_path"),this._openPopup&&(this.openPopup=this._openPopup,delete this._openPopup)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=L.Polygon.extend({isEmpty:function(){var e=this.getLatLngs();return null===e||void 0===e||e&&0===e.length},getHole:function(e){if($.isNumeric(e))return this._holes[e]},getHolePoint:function(e,t){if($.isNumeric(e)||$.isNumeric(t))return this._holes[e][t]},getHoles:function(){return this._holes},clearHoles:function(){this._holes=[],this.redraw()},clear:function(){this.clearHoles(),$.isArray(this._latlngs)&&void 0!==this._latlngs[0]&&this.setLatLngs([])},updateHolePoint:function(e,t,i){return $.isNumeric(e)&&$.isNumeric(t)?this._holes[e][t]=i:$.isNumeric(e)&&!$.isNumeric(t)?this._holes[e]=i:this._holes=i,this},setHoles:function(e){this._holes=e},setHolePoint:function(e,t,i){var o=this.getLayers()[0];return o&&$.isNumeric(e)&&$.isNumeric(t)&&(o._holes[e][t]=i),this}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=t.precision=function(e,t){var i=(""+e).split(".");if(t=t||0,!e||1===i.length)return e;var o=0;if(i[1].length>0){var n=i[1].length<t?i[1].length:t;o=e.toPrecision(i[0].length+n)}return Number(o)};t.precisionGeoJSON=function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(null===e||void 0===e)throw new Error("Please, make sure that first arguments is geoJSON");var n=(t=JSON.parse(JSON.stringify(e))).geometry,r=n.type,s=n.coordinates;if(!Array.isArray(s))throw new Error("Please, make sure that geoJSON has correct structure");return"Polygon"===r&&i>0&&s.forEach(function(e){e.forEach(function(e){e[0]=o(e[0],i),e[1]=o(e[1],i)})}),"MultiPolygon"===r&&i>0&&s.forEach(function(e){e.forEach(function(e){e.forEach(function(e){e[0]=o(e[0],i),e[1]=o(e[1],i)})})}),t}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=this;if((0,d.default)(this),(0,c.default)(this),this.options.defaultControlLayers){var t=L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'});this.addLayer(t),this._controlLayers=new L.Control.Layers({Google:new L.Google,OSM:t}),this.addControl(this._controlLayers)}this.touchZoom.disable(),this.doubleClickZoom.disable(),this.boxZoom.disable(),this.keyboard.disable();var i=this.options.controls;i&&i.geoSearch&&this.addControl(new o.default),this._BtnControl=s.default;var u=new n.default({btns:[{className:"fa fa-trash"}]}),h=void 0;i&&i.loadBtn&&(h=new r.default({btns:[{className:"fa fa-arrow-circle-o-down load"}]}));var _=this.msgHelper=new a.default({defaultMsg:this.options.text.clickToStartDrawPolygonOnMap});this.on("msgHelperAdded",function(){var t=e.options.text;e.on("editor:marker_group_select",function(){e.off("editor:not_selected_marker_mouseover"),e.on("editor:not_selected_marker_mouseover",function(e){_.msg(t.clickToSelectEdges,null,e.marker)}),e.off("editor:selected_marker_mouseover"),e.on("editor:selected_marker_mouseover",function(e){_.msg(t.clickToRemoveAllSelectedEdges,null,e.marker)}),e.off("editor:selected_middle_marker_mouseover"),e.on("editor:selected_middle_marker_mouseover",function(e){_.msg(t.clickToAddNewEdges,null,e.marker)}),e.off("editor:edit_polygon_mousemove"),e.on("editor:edit_polygon_mousemove",function(e){_.msg(t.clickToDrawInnerEdges,null,e.layerPoint)}),e.off("editor:edit_polygon_mouseout"),e.on("editor:edit_polygon_mouseout",function(){_.hide(),e._storedLayerPoint=null}),e.off("editor:view_polygon_mousemove"),e.on("editor:view_polygon_mousemove",function(e){_.msg(t.clickToEdit,null,e.layerPoint)}),e.off("editor:view_polygon_mouseout"),e.on("editor:view_polygon_mouseout",function(){_.hide(),e._storedLayerPoint=null})}),e.off("editor:marker_mouseout"),e.on("editor:marker_mouseout",function(){_.hide()}),e.off("editor:first_marker_mouseover"),e.on("editor:first_marker_mouseover",function(e){_.msg(t.clickToJoinEdges,null,e.marker)}),e.off("editor:last_marker_dblclick_mouseover"),e.on("editor:last_marker_dblclick_mouseover",function(e){_.msg(t.dblclickToJoinEdges,null,e.marker)}),e.on("editor:__join_path",function(t){t.marker&&_.msg(e.options.text.clickToRemoveAllSelectedEdges,null,t.marker)}),e.on("editor:intersection_detected",function(t){t.intersection?(_.msg(e.options.text.intersection,"error",e._storedLayerPoint||e.getSelectedMarker()),e._storedLayerPoint=null):_.hide();var i=e.getSelectedMarker();e.hasLayer(i)&&(i&&!i._mGroup.hasFirstMarker()&&(t.intersection?i.setIntersectedStyle():(i.resetStyle(),i._mGroup.getLayers().filter(function(e){return L.DomUtil.hasClass(e._icon,"m-editor-intersection-div-icon")}).map(function(e){return e.resetStyle()}))))})}),l.default.isMobileBrowser()||(this.addControl(_),i&&i.loadBtn&&this.addControl(h)),i&&i.trashBtn&&this.addControl(u)};var o=u(i(16)),n=u(i(17)),r=u(i(18)),s=u(i(1)),a=u(i(19)),l=u(i(2)),d=u(i(20)),c=u(i(21));function u(e){return e&&e.__esModule?e:{default:e}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=L.Control.extend({options:{position:"topleft",email:""},onAdd:function(e){this._map=e;var t=L.DomUtil.create("div","leaflet-bar leaflet-search-bar"),i=document.createElement("div");t.appendChild(i);var o=L.DomUtil.create("a","",i);o.href="#";var n=L.DomEvent.stopPropagation;L.DomEvent.on(o,"click",n).on(o,"mousedown",n).on(o,"dblclick",n).on(o,"click",L.DomEvent.preventDefault).on(o,"click",this._toggle,this),o.appendChild(L.DomUtil.create("i","fa fa-search"));var r=this._form=document.createElement("form");L.DomEvent.on(r,"mousewheel",n),L.DomEvent.on(r,"DOMMouseScroll",n),L.DomEvent.on(r,"MozMousePixelScroll",n);var s=this._input=document.createElement("input");L.DomEvent.on(s,"click",n).on(s,"mousedown",n),r.appendChild(s);var a=this._submitBtn=L.DomUtil.create("button","leaflet-submit-btn search");return a.type="submit",L.DomEvent.on(a,"click",n).on(a,"mousedown",n).on(a,"click",this._doSearch,this),r.appendChild(a),this._btnTextContainer=L.DomUtil.create("span","text"),this._btnTextContainer.innerHTML=this._map.options.text.submitLoadBtn,a.appendChild(this._btnTextContainer),this._spinIcon=L.DomUtil.create("i","fa fa-refresh fa-spin"),a.appendChild(this._spinIcon),L.DomEvent.on(r,"submit",n).on(r,"submit",L.DomEvent.preventDefault),t.appendChild(r),this._map.on("loadBtnOpened",this._collapse,this),L.DomEvent.addListener(t,"mouseover",this._onMouseOver,this),L.DomEvent.addListener(t,"mouseout",this._onMouseOut,this),this._titleContainer=L.DomUtil.create("div","btn-leaflet-msg-container title-hidden"),this._titleContainer.innerHTML=this._map.options.text.searchLocation,t.appendChild(this._titleContainer),t},_toggle:function(){"block"!=this._form.style.display?(this._form.style.display="block",this._input.focus(),this._map.fire("searchEnabled")):(this._collapse(),this._map.fire("searchDisabled")),L.DomUtil.addClass(this._titleContainer,"title-hidden")},_collapse:function(){this._form.style.display="none",this._input.value=""},_nominatimCallback:function(e){this._results&&this._results.parentNode&&this._results.parentNode.removeChild(this._results);var t=this._results=document.createElement("div");t.style.height="80px",t.style.overflowY="auto",t.style.overflowX="hidden",t.style.backgroundColor="white",t.style.margin="3px",t.style.padding="2px",t.style.border="2px grey solid",t.style.borderRadius="2px",L.DomEvent.on(t,"mousedown",L.DomEvent.stopPropagation),L.DomEvent.on(t,"mousewheel",L.DomEvent.stopPropagation),L.DomEvent.on(t,"DOMMouseScroll",L.DomEvent.stopPropagation),L.DomEvent.on(t,"MozMousePixelScroll",L.DomEvent.stopPropagation);for(var i=[],o=0;o<e.length;o++){var n=L.DomUtil.create("div","search-results-el");n.innerHTML=e[o].display_name,n.title=e[o].display_name,t.appendChild(n);var r=function(e,t,o){return function(){for(var n=0;n<i.length;n++)L.DomUtil.removeClass(i[n],"selected");L.DomUtil.addClass(o,"selected");var r=t.boundingbox;e.fitBounds(L.latLngBounds([[r[0],r[2]],[r[1],r[3]]]))}}(this._map,e[o],n);L.DomEvent.on(n,"click",L.DomEvent.stopPropagation),L.DomEvent.on(n,"mousewheel",L.DomEvent.stopPropagation),L.DomEvent.on(n,"MozMousePixelScroll",L.DomEvent.stopPropagation),L.DomEvent.on(n,"DOMMouseScroll",L.DomEvent.stopPropagation).on(n,"click",r),i.push(n)}this._form.appendChild(t),0===e.length&&this._results.parentNode.removeChild(this._results),L.DomUtil.removeClass(this._submitBtn,"loading")},_callbackId:0,_doSearch:function(){L.DomUtil.addClass(this._submitBtn,"loading");var e="_l_osmgeocoder_"+this._callbackId++;window[e]=L.Util.bind(this._nominatimCallback,this);var t={q:this._input.value,format:"json",limit:10,json_callback:e};this.options.email&&(t.email=this.options.email),this._map.getBounds()&&(t.viewbox=this._map.getBounds().toBBoxString());var i="http://nominatim.openstreetmap.org/search"+L.Util.getParamString(t),o=document.createElement("script");o.type="text/javascript",o.src=i,document.getElementsByTagName("head")[0].appendChild(o)},_onMouseOver:function(){"block"!==this._form.style.display&&L.DomUtil.removeClass(this._titleContainer,"title-hidden")},_onMouseOut:function(){L.DomUtil.addClass(this._titleContainer,"title-hidden")}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=i(1),r=(o=n)&&o.__esModule?o:{default:o};t.default=r.default.extend({options:{eventName:"trashAdded",pressEventName:"trashBtnPressed"},_btn:null,onAdd:function(e){var t=this;e.on("trashAdded",function(i){L.DomUtil.addClass(i.control._btn,"disabled"),e.on("editor:marker_group_select",t._bindEvents,t),e.on("editor:start_add_new_polygon",t._bindEvents,t),e.on("editor:start_add_new_hole",t._bindEvents,t),e.on("editor:marker_group_clear",t._disableBtn,t),e.on("editor:delete_polygon",t._disableBtn,t),e.on("editor:delete_hole",t._disableBtn,t),e.on("editor:map_cleared",t._disableBtn,t),t._disableBtn()});var i=r.default.prototype.onAdd.call(this,e);return this._titleContainer=L.DomUtil.create("div","btn-leaflet-msg-container title-hidden"),this._titleContainer.innerHTML=this._map.options.text.loadJson,i.appendChild(this._titleContainer),i},_bindEvents:function(){L.DomUtil.removeClass(this._btn,"disabled"),L.DomEvent.addListener(this._btn,"mouseover",this._onMouseOver,this),L.DomEvent.addListener(this._btn,"mouseout",this._onMouseOut,this),L.DomEvent.addListener(this._btn,"click",this._onPressBtn,this)},_disableBtn:function(){L.DomUtil.addClass(this._btn,"disabled"),L.DomEvent.removeListener(this._btn,"mouseover",this._onMouseOver),L.DomEvent.removeListener(this._btn,"mouseout",this._onMouseOut),L.DomEvent.removeListener(this._btn,"click",this._onPressBtn,this)},_onPressBtn:function(){var e=this._map,t=e.getSelectedMGroup();t===e.getEMarkersGroup()&&t.getLayers()[0]._isFirst?(e.clear(),e.mode("draw")):(t.remove(),t.getDELine().clear(),L.DomUtil.addClass(this._btn,"disabled"),e.fire("editor:polygon:deleted")),this._onMouseOut(),L.DomUtil.addClass(this._titleContainer,"title-hidden")},_onMouseOver:function(){if(!L.DomUtil.hasClass(this._btn,"disabled")){var e=this._map,t=e.getEMarkersGroup().getLayers()[0];t&&t._isFirst?this._titleContainer.innerHTML=e.options.text.rejectChanges:this._titleContainer.innerHTML=e.options.text.deleteSelectedEdges,L.DomUtil.removeClass(this._titleContainer,"title-hidden")}},_onMouseOut:function(){L.DomUtil.hasClass(this._btn,"disabled")||L.DomUtil.addClass(this._titleContainer,"title-hidden")}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=i(1),r=(o=n)&&o.__esModule?o:{default:o};t.default=r.default.extend({options:{eventName:"loadBtnAdded",pressEventName:"loadBtnPressed"},onAdd:function(e){var t=this,i=r.default.prototype.onAdd.call(this,e);return e.on("loadBtnAdded",function(){t._map.on("searchEnabled",t._collapse,t),t._renderForm(i)}),L.DomUtil.addClass(i,"load-json-container"),i},_onPressBtn:function(){this._timeout&&clearTimeout(this._timeout),L.DomUtil.addClass(this._titleContainer,"title-hidden"),"block"!=this._form.style.display?(this._form.style.display="block",this._textarea.focus(),this._map.fire("loadBtnOpened")):(this._collapse(),this._map.fire("loadBtnHidden"))},_collapse:function(){this._form.style.display="none",this._textarea.value=""},_renderForm:function(e){var t=this._form=L.DomUtil.create("form"),i=this._textarea=L.DomUtil.create("textarea");i.style.width="200px",i.style.height="100px",i.style.border="1px solid white",i.style.padding="5px",i.style.borderRadius="4px",L.DomEvent.on(i,"click",this.stopEvent).on(i,"mousedown",this.stopEvent).on(i,"dblclick",this.stopEvent).on(i,"mousewheel",this.stopEvent),t.appendChild(i);var o=this._submitBtn=L.DomUtil.create("button","leaflet-submit-btn load-geojson");o.type="submit",o.innerHTML=this._map.options.text.submitLoadBtn,L.DomEvent.on(o,"click",this.stopEvent).on(o,"mousedown",this.stopEvent).on(o,"click",this._submitForm,this),t.appendChild(o),L.DomEvent.on(t,"submit",L.DomEvent.preventDefault),e.appendChild(t),this._titleContainer=L.DomUtil.create("div","btn-leaflet-msg-container title-hidden"),this._titleContainer.innerHTML=this._map.options.text.loadJson,e.appendChild(this._titleContainer)},_timeout:null,_submitForm:function(){var e,t=this;this._timeout&&clearTimeout(this._timeout);var i=this._map;try{e=JSON.parse(this._textarea.value),L.DomUtil.removeClass(this._titleContainer,"title-hidden"),L.DomUtil.removeClass(this._titleContainer,"title-error"),L.DomUtil.addClass(this._titleContainer,"title-success"),this._titleContainer.innerHTML=i.options.text.jsonWasLoaded,i.createEditPolygon(e),this._timeout=setTimeout(function(){L.DomUtil.addClass(t._titleContainer,"title-hidden")},2e3),this._collapse(),this._map.fire("loadBtnHidden")}catch(e){L.DomUtil.removeClass(this._titleContainer,"title-hidden"),L.DomUtil.addClass(this._titleContainer,"title-error"),L.DomUtil.removeClass(this._titleContainer,"title-success"),this._titleContainer.innerHTML=i.options.text.checkJson,this._timeout=setTimeout(function(){L.DomUtil.addClass(t._titleContainer,"title-hidden")},2e3),this._collapse(),this._map.fire("loadBtnHidden"),this._map.mode("draw")}},_onMouseOver:function(){"block"!==this._form.style.display&&(L.DomUtil.removeClass(this._titleContainer,"title-hidden"),L.DomUtil.removeClass(this._titleContainer,"title-error"),L.DomUtil.removeClass(this._titleContainer,"title-success"),this._titleContainer.innerHTML=this._map.options.text.loadJson)},_onMouseOut:function(){L.DomUtil.addClass(this._titleContainer,"title-hidden")}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=L.Control.extend({options:{position:"msgcenter",defaultMsg:null},initialize:function(e){L.Util.setOptions(this,e)},_titleContainer:null,onAdd:function(e){var t=this,i=L.DomUtil.create("div","leaflet-bottom"),o=L.DomUtil.create("div","leaflet-msg-editor");return e._controlCorners.msgcenter=i,e._controlContainer.appendChild(i),setTimeout(function(){t._setContainer(o,e),e.fire("msgHelperAdded",{control:t}),t._changePos()},1e3),e.getBtnControl=function(){return t},this._bindEvents(e),o},_changePos:function(){var e=this._map._controlCorners.msgcenter;if(e&&e.children.length){var t=e.children[0].children[0];if(!t)return;var i=t.clientWidth;i&&(e.style.left=(this._map._container.clientWidth-i)/2+"px")}},_bindEvents:function(){var e=this;setTimeout(function(){window.addEventListener("resize",function(){e._changePos()})},1)},_setContainer:function(e){this._titleContainer=L.DomUtil.create("div","leaflet-msg-container title-hidden"),this._titlePosContainer=L.DomUtil.create("div","leaflet-msg-container title-hidden"),e.appendChild(this._titleContainer),document.body.appendChild(this._titlePosContainer),null!==this.options.defaultMsg&&(L.DomUtil.removeClass(this._titleContainer,"title-hidden"),this._titleContainer.innerHTML=this.options.defaultMsg)},getOffset:function(e){var t=0,i=0;if(!this._map.isFullscreen||!this._map.isFullscreen())for(;e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)t+=e.offsetLeft,i+=e.offsetTop,e=e.offsetParent;return{y:i,x:t}},msg:function(e,t,i){if(e&&this._titlePosContainer)if(i){var o;L.DomUtil.removeClass(this._titlePosContainer,"title-hidden"),L.DomUtil.removeClass(this._titlePosContainer,"title-error"),L.DomUtil.removeClass(this._titlePosContainer,"title-success"),this._titlePosContainer.innerHTML=e;var n=this.getOffset(this._map._container);i instanceof L.Point?(o=i,o=this._map.layerPointToContainerPoint(o)):o=this._map.latLngToContainerPoint(i.getLatLng()),o.x+=n.x,o.y+=n.y,this._titlePosContainer.style.top=o.y-8+"px",this._titlePosContainer.style.left=o.x+10+"px",t&&L.DomUtil.addClass(this._titlePosContainer,"title-"+t)}else L.DomUtil.removeClass(this._titleContainer,"title-hidden"),L.DomUtil.removeClass(this._titleContainer,"title-error"),L.DomUtil.removeClass(this._titleContainer,"title-success"),this._titleContainer.innerHTML=e,t&&L.DomUtil.addClass(this._titleContainer,"title-"+t),this._changePos()},hide:function(){this._titleContainer&&L.DomUtil.addClass(this._titleContainer,"title-hidden"),this._titlePosContainer&&L.DomUtil.addClass(this._titlePosContainer,"title-hidden")},getBtnContainer:function(){return this._map._controlCorners.msgcenter},getBtnAt:function(e){return this.getBtnContainer().child[e]},disableBtn:function(e){L.DomUtil.addClass(this.getBtnAt(e),"disabled")},enableBtn:function(e){L.DomUtil.removeClass(this.getBtnAt(e),"disabled")}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.options.controls;if((!t||t.zoom)&&e.zoomControl){var i=e.zoomControl._container;e._titleZoomContainer=L.DomUtil.create("div","btn-leaflet-msg-container zoom title-hidden"),e._titleZoomContainer.innerHTML=e.options.text.zoom,i.appendChild(e._titleZoomContainer);L.DomEvent.addListener(i,"mouseover",function(){L.DomUtil.removeClass(e._titleZoomContainer,"title-hidden")},this),L.DomEvent.addListener(i,"mouseout",function(){L.DomUtil.addClass(e._titleZoomContainer,"title-hidden")},this),e.zoomControl._zoomInButton.title="",e.zoomControl._zoomOutButton.title=""}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(e.options.fullscreenControl){var t=e.fullscreenControl.link;t.title="",L.DomUtil.addClass(t,"full-screen"),e.off("fullscreenchange"),e.on("fullscreenchange",function(){L.DomUtil.addClass(e._titleFullScreenContainer,"title-hidden"),e.isFullscreen()?e._titleFullScreenContainer.innerHTML=e.options.text.hideFullScreen:e._titleFullScreenContainer.innerHTML=e.options.text.showFullScreen},this);var i=e.fullscreenControl._container;e._titleFullScreenContainer=L.DomUtil.create("div","btn-leaflet-msg-container title-hidden"),e._titleFullScreenContainer.innerHTML=e.options.text.showFullScreen,i.appendChild(e._titleFullScreenContainer);L.DomEvent.addListener(i,"mouseover",function(){L.DomUtil.removeClass(e._titleFullScreenContainer,"title-hidden")},this),L.DomEvent.addListener(i,"mouseout",function(){L.DomUtil.addClass(e._titleFullScreenContainer,"title-hidden")},this)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=d(i(23)),n=d(i(3)),r=d(i(24)),s=d(i(5)),a=d(i(6)),l=d(i(25));function d(e){return e&&e.__esModule?e:{default:e}}i(26),t.default={viewGroup:null,editGroup:null,editPolygon:null,editMarkersGroup:null,editLineGroup:null,dashedEditLineGroup:null,editHoleMarkersGroup:null,setLayers:function(){this.viewGroup=new o.default([]),this.editGroup=new l.default([]),this.editPolygon=new n.default([]),this.editMarkersGroup=new L.MarkerGroup([]),this.editLineGroup=new s.default([]),this.dashedEditLineGroup=new a.default([]),this.editHoleMarkersGroup=new r.default([])}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=L.MultiPolygon.extend({initialize:function(e,t){var i=this;L.MultiPolygon.prototype.initialize.call(this,e,t),this.on("layeradd",function(e){var t=i._map.options.style.view;e.target.setStyle($.extend({opacity:.7,fillOpacity:.35,color:"#00ABFF"},t)),i._map._moveEPolygonOnTop()})},isEmpty:function(){return 0===this.getLayers().length},onAdd:function(e){L.MultiPolygon.prototype.onAdd.call(this,e),this.on("mousemove",function(t){var i=e.getEMarkersGroup();i.isEmpty()?e.fire("editor:view_polygon_mousemove",{layerPoint:t.layerPoint}):i.getFirst()._hasFirstIcon()||e.fire("editor:view_polygon_mousemove",{layerPoint:t.layerPoint})}),this.on("mouseout",function(){var t=e.getEMarkersGroup();t.isEmpty()?e.fire("editor:view_polygon_mouseout"):t.getFirst()._hasFirstIcon()||e.fire("editor:view_polygon_mouseout")})},onClick:function(e){var t,i=this._map,o=i.getSelectedMGroup();(t=i.getEMarkersGroup()).getFirst()&&t.getFirst()._hasFirstIcon()&&!t.isEmpty()||o&&o.getFirst()&&o.getFirst()._hasFirstIcon()&&!o.isEmpty()?((t=i.getEMarkersGroup()).set(e.latlng),i._convertToEdit(t)):(i._getSelectedVLayer()?i._setEPolygon_To_VGroup():i._addEPolygon_To_VGroup(),i.clear(),i.mode("draw"),i._hideSelectedVLayer(e.layer),t.restore(e.layer),i._convertToEdit(t),t.select())},onRemove:function(e){this.off("mouseover"),this.off("mouseout"),e.off("editor:view_polygon_mousemove"),e.off("editor:view_polygon_mouseout")}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=L.FeatureGroup.extend({_selected:!1,_lastHole:void 0,_lastHoleToDraw:void 0,addHoleGroup:function(){return this._lastHole=new L.MarkerGroup,this._lastHole._isHole=!0,this._lastHole.addTo(this),this._lastHole.position=this.getLength()-1,this._lastHoleToDraw=this._lastHole,this._lastHole},getLength:function(){return this.getLayers().length},resetLastHole:function(){this._lastHole=void 0},setLastHole:function(e){this._lastHole=e},getLastHole:function(){return this._lastHole},remove:function(){this.eachLayer(function(e){for(;e.getLayers().length;)e.removeMarkerAt(0)})},repos:function(e){this.eachLayer(function(t){t.position>=e&&(t.position-=1)})},resetSelection:function(){this.eachLayer(function(e){e.getLayers()._each(function(e){e.unSelectIconInGroup()})}),this._selected=!1}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=L.FeatureGroup.extend({isEmpty:function(){return 0===this.getLayers().length}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=l(i(27)),n=l(i(8)),r=(l(i(5)),l(i(6))),s=l(i(9)),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(0));function l(e){return e&&e.__esModule?e:{default:e}}L.Util.extend(L.LineUtil,{segmentsIntersect:function(e,t,i,o){return this._checkCounterclockwise(e,i,o)!==this._checkCounterclockwise(t,i,o)&&this._checkCounterclockwise(e,t,i)!==this._checkCounterclockwise(e,t,o)},_checkCounterclockwise:function(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}});var d=!1;t.default=L.MarkerGroup=o.default.extend({_isHole:!1,_editLineGroup:void 0,_position:void 0,dashedEditLineGroup:new r.default([]),options:{mIcon:void 0,mHoverIcon:void 0},initialize:function(e){L.LayerGroup.prototype.initialize.call(this,e),this._markers=[]},onAdd:function(e){this._map=e,this.dashedEditLineGroup.addTo(e)},_updateDELine:function(e){var t=this.getDELine();return this._firstMarker&&t.update(e),t},_addMarker:function(e){this.set(e),this.getDELine().addLatLng(e),this._map._convertToEdit(this)},getDELine:function(){return this.dashedEditLineGroup._map||this.dashedEditLineGroup.addTo(this._map),this.dashedEditLineGroup},_setHoverIcon:function(){var e=this._map;void 0!==e._oldSelectedMarker&&e._oldSelectedMarker._resetIcon(this.options.mIcon),e._selectedMarker._setHoverIcon(this.options.mHoverIcon)},_sortByPosition:function(){if(!this._isHole){var e=this.getLayers(),t=[],i=[];(e=e.sort(function(e,t){return e._leaflet_id-t._leaflet_id})).forEach(function(e){t.push(e._leaflet_id),i.push(e.__position)}),(0,s.default)(this._layers,t)}},updateStyle:function(){for(var e=this.getLayers(),t=0;t<e.length;t++){var i=e[t];i._resetIcon(this.options.mIcon),i===this._map._selectedMarker&&this._setHoverIcon()}},setSelected:function(e){var t=this._map;if(t.__polygonEdgesIntersected&&this.hasFirstMarker())return t._selectedMarker=this.getLast(),void(t._oldSelectedMarker=t._selectedMarker);t._oldSelectedMarker=t._selectedMarker,t._selectedMarker=e},resetSelected:function(){var e=this._map;e._selectedMarker&&(e._selectedMarker._resetIcon(this.options.mIcon),e._selectedMarker=void 0)},getSelected:function(){return this._map._selectedMarker},_setFirst:function(e){this._firstMarker=e,this._firstMarker._setFirstIcon()},getFirst:function(){return this._firstMarker},getLast:function(){if(this.hasFirstMarker()){var e=this.getLayers();return e[e.length-1]}},hasFirstMarker:function(){return this.getFirst()&&this.getFirst()._hasFirstIcon()},convertToLatLngs:function(){var e=[];return this.eachLayer(function(t){t.isMiddle()||e.push(t.getLatLng())}),e},restore:function(e){this.setAll(e._latlngs),this.setAllHoles(e._holes)},_add:function(e,t){var i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._map.isMode("draw")&&(this._firstMarker||(o.icon=a.firstIcon));var n=this.addMarker(e,t,o);return this.getDELine().addLatLng(e),d=!0,this.getFirst()._hasFirstIcon()?(this._map.on("mousemove",function(e){d||i._updateDELine(e.latlng)}),d=!1):this.getDELine().clear(),n._mGroup.getLayers().length>2&&n._mGroup._firstMarker._hasFirstIcon()&&n===n._mGroup._lastMarker&&this._map.fire("editor:last_marker_dblclick_mouseover",{marker:n}),n},_closestNotMiddleMarker:function(e,t,i){return e[t].isMiddle()?e[t+i]:e[t]},_setPrevNext:function(e,t){var i=this.getLayers(),o=i.length-1;return 1===t?(e._prev=this._closestNotMiddleMarker(i,t-1,-1),e._next=this._closestNotMiddleMarker(i,2,1)):t===o?(e._prev=this._closestNotMiddleMarker(i,o-1,-1),e._next=this._closestNotMiddleMarker(i,0,1)):(null==e._middlePrev&&(e._prev=i[t-1]),null==e._middleNext&&(e._next=i[t+1])),e},setMiddleMarker:function(e){this.addMarker(e,null,{icon:a.middleIcon})},setMiddleMarkers:function(e){this.setMiddleMarker(e),this.setMiddleMarker(e+2)},set:function(e,t,i){if(!this.hasIntersection(e))return this._map.edgesIntersected(!1),this._add(e,t,i)},setMiddle:function(e,t,i){t=t<0?0:t;var o=this.set(e,t,i);return o._setMiddleIcon(),o},setAll:function(e){var t=this;e.forEach(function(e,i){t.set(e,i)}),this.getFirst().fire("click")},setAllHoles:function(e){var t=this;e.forEach(function(e){var i=t._map.getEHMarkersGroup().addHoleGroup();e._each(function(e,t){i.set(e,t)}),i.getFirst().fire("click")})},setHoleMarker:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{isHoleMarker:!0,holePosition:{}},i=new n.default(this,e,t||{});return i.addTo(this),this._map.isMode("draw")&&1===this.getLayers().length&&this._setFirst(i),i},removeHole:function(){var e=this._map;this.clearLayers(),e.getEPolygon().getHoles().splice(this._position,1),e.getEPolygon().redraw(),e.getEHMarkersGroup().clearLayers();for(var t=e.getEPolygon().getHoles(),i=0;i<t.length;i++)e._setEHMarkerGroup(t[i])},removeSelected:function(){var e=this,t=this.getSelected(),i=this.getLayers(),o=t.getLatLng(),n=this._map;if(i.length>0&&(this.removeLayer(t),n.fire("editor:delete_marker",{latlng:o})),i=this.getLayers(),this._isHole){if(n.isMode("edit")){if(i.length<4)this.removeHole();else{t.options.holePosition;n.getEPolygon().getHole(this._position).splice(t.__position,1),n.getEPolygon().redraw()}var r=0;this.eachLayer(function(t){t.options.holePosition={hGroup:e._position,hMarker:r++}})}}else n.isMode("edit")&&i.length<3&&(this.clearLayers(),n.getEPolygon().clear());var s=0;this.eachLayer(function(e){e.options.title=s,e.__position=s++})},getPointsForIntersection:function(e){var t=this,i=this._map;this._originalPoints=[];var o=(e?e.getLayers():this.getLayers()).filter(function(e){return!e.isMiddle()});if(this._originalPoints=[],o._each(function(e){var i=e.getLatLng();t._originalPoints.push(new L.Point(i.lng,i.lat))}),!e)if(i._selectedMarker===o[0])this._originalPoints=this._originalPoints.slice(1);else if(i._selectedMarker===o[o.length-1])this._originalPoints.splice(-1);else for(var n=[],r=1;r<o.length;r++)if(i._selectedMarker===o[r]){n=this._originalPoints.splice(r+1),this._originalPoints=n.concat(this._originalPoints),this._originalPoints.splice(-1);break}return this._originalPoints},_bindLineEvents:void 0,_hasIntersection:function(e,t,i){var o=e?e.length:0,n=e?e[o-1]:null,r=o-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(n,t,r,i)},_hasIntersectionWithHole:function(e,t,i){e&&e.length;return!this._tooFewPointsForIntersection(1)&&this._lineHoleSegmentsIntersectsRange(i,t)},hasIntersection:function(e,t){var i=this._map;if(i.options.allowIntersection)return!1;var o=new L.Point(e.lng,e.lat),n=this.getPointsForIntersection(),r=this._hasIntersection(n,o,t),s=!1,a=this.getFirst();return a&&!a._hasFirstIcon()&&(n=this.getPointsForIntersection().reverse(),s=this._hasIntersection(n,o,t)),i.edgesIntersected(r||s),i.edgesIntersected()},hasIntersectionWithHole:function(e,t){if(this._map.options.allowIntersection)return!1;var i=new L.Point(e[0].lng,e[0].lat),o=new L.Point(e[1].lng,e[1].lat),n=this.getPointsForIntersection(t),r=this._hasIntersectionWithHole(n,i,o);n=this.getPointsForIntersection(t).reverse(),o=new L.Point(e[2].lng,e[2].lat);var s=this._hasIntersectionWithHole(n,i,o);return this._map.edgesIntersected(r||s),this._map.edgesIntersected()},_tooFewPointsForIntersection:function(e){var t=this._originalPoints,i=t?t.length:0;return i+=e||0,!this._originalPoints||i<=3},_lineHoleSegmentsIntersectsRange:function(e,t){for(var i,o,n=this._originalPoints,r=n.length-1;r>0;r--)if(i=n[r-1],o=n[r],L.LineUtil.segmentsIntersect(e,t,i,o))return!0;return!1},_lineSegmentsIntersectsRange:function(e,t,i,o){for(var n,r,s=this._originalPoints,a=o?1:0,l=i;l>a;l--)if(n=s[l-1],r=s[l],L.LineUtil.segmentsIntersect(e,t,n,r))return!0;return!1},_isMarkerInPolygon:function(e){for(var t=0,i=this.getLayers(),o=i.length,n=e.lng,r=e.lat,s=!1,a=0;a<o;a++){++t==o&&(t=0);var l=i[a].getLatLng(),d=i[t].getLatLng();(l.lat<r&&d.lat>=r||d.lat<r&&l.lat>=r)&&l.lng+(r-l.lat)/(d.lat-l.lat)*(d.lng-l.lng)<n&&(s=!s)}return s}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(i(8));n(i(9));function n(e){return e&&e.__esModule?e:{default:e}}t.default=L.Class.extend({includes:L.Mixin.Events,_selected:!1,_lastMarker:void 0,_firstMarker:void 0,_positionHash:void 0,_lastPosition:0,_markers:[],onAdd:function(e){this._map=e,this.clearLayers()},onRemove:function(e){this.clearLayers()},clearLayers:function(){var e=this;this._markers.forEach(function(t){e._map.removeLayer(t)}),this._markers=[]},addTo:function(e){e.addLayer(this)},addLayer:function(e){this._map.addLayer(e),this._markers.push(e),null!=e.position&&this._markers.move(this._markers.length-1,e.position),e.position=null!=e.position?e.position:this._markers.length-1},remove:function(){var e=this;this.getLayers()._each(function(t){for(;e.getLayers().length;)e.removeMarker(t)});var t=this._map;this._isHole?t.fire("editor:polygon:hole_deleted"):(t.getVGroup().removeLayer(t._getSelectedVLayer()),t.fire("editor:polygon:deleted"))},removeLayer:function(e){var t=e.position;this._map.removeLayer(e),this._markers.splice(t,1)},getLayers:function(){return this._markers},eachLayer:function(e){this._markers.forEach(e)},markerAt:function(e){var t=this._markers[e];return e<0?this.firstMarker():(void 0===t&&(t=this.lastMarker()),t)},firstMarker:function(){return this._markers[0]},lastMarker:function(){var e=this._markers;return e[e.length-1]},removeMarker:function(e){var t=!e.isMiddle(),i=e._prev,o=e._next,n=e._next._next;this.removeMarkerAt(e.position),this.removeMarkerAt(i.position),this.removeMarkerAt(o.position);var r=this._map;this.getLayers().length>0?(this.setMiddleMarker(n.position),t&&r.fire("editor:delete_marker",{marker:e})):(this._isHole?(r.removeLayer(this),r.fire("editor:delete_hole",{marker:e})):(r.removePolygon(r.getEPolygon()),r.fire("editor:delete_polygon")),r.fire("editor:marker_group_clear"))},removeMarkerAt:function(e){var t;if(0!==this.getLayers().length&&"number"==typeof e){t=this.markerAt(e);var i=!1,o=this._markers;if(o.forEach(function(e){i&&(e.position=0===e.position?0:e.position-1),e===t&&(t._prev._next=t._next,t._next._prev=t._prev,i=!0)}),this.removeLayer(t),o.length<5&&(this.clear(),!this._isHole)){var n=this._map;n.getEPolygon().clear(),n.getVGroup().removeLayer(n._getSelectedVLayer())}}},addMarker:function(e,t,i){if("number"==typeof e){t=this.markerAt(e).position,this._recalcPositions(t);var n=t-1<0?this.lastMarker():this.markerAt(t-1),r=this.markerAt(-1==t?1:t);e=this._getMiddleLatLng(n,r)}0===this.getLayers().length&&(i.draggable=!1),this.getFirst()&&(i.draggable=!this.getFirst()._hasFirstIcon());var s=new o.default(this,e,i);return this._firstMarker||(this._firstMarker=s,this._lastMarker=s),void 0!==t&&(s.position=t),this.addLayer(s),s.position=void 0!==s.position?s.position:this._lastPosition++,s._prev=this._lastMarker,this._firstMarker._prev=s,s._prev&&(this._lastMarker._next=s,s._next=this._firstMarker),void 0===t&&(this._lastMarker=s),void 0!==t&&this._recalcRelations(s),s.isMiddle()||this._map.fire("editor:add_marker",{marker:s}),s},clear:function(){var e=this,t=this._ids();this.clearLayers(),t.forEach(function(t){e._deleteEvents(t)}),this._lastPosition=0,this._firstMarker=void 0},_deleteEvents:function(e){delete this._map._leaflet_events.viewreset_idx[e],delete this._map._leaflet_events.zoomanim_idx[e]},_getMiddleLatLng:function(e,t){var i=this._map,o=i.project(e.getLatLng()),n=i.project(t.getLatLng());return i.unproject(o._add(n)._divideBy(2))},_recalcPositions:function(e){var t=this,i=!1;this._markers.forEach(function(o,n){e===n&&(i=!0),i&&(t._markers[n].position+=1)})},_recalcRelations:function(){var e=this,t=this._markers;t.forEach(function(i,o){i._prev=e.markerAt(o-1),i._next=e.markerAt(o+1),0===o&&(i._prev=e.lastMarker(),i._next=e.markerAt(1)),o===t.length-1&&(i._prev=e.markerAt(o-1),i._next=e.markerAt(0))})},_ids:function(){var e=[];for(var t in this._layers)e.push(t);return e.sort(function(e,t){return e-t}),e},select:function(){if(this.isEmpty())this._map._selectedMGroup=null;else{var e=this._map;this._isHole?(e.getEHMarkersGroup().resetSelection(),e.getEMarkersGroup().resetSelection(),e.getEHMarkersGroup().setLastHole(this)):(e.getEHMarkersGroup().resetSelection(),e.getEHMarkersGroup().resetLastHole()),this.getLayers()._each(function(e){e.selectIconInGroup()}),this._selected=!0,this._map._selectedMGroup=this,this._map.fire("editor:marker_group_select")}},isEmpty:function(){return 0===this.getLayers().length},resetSelection:function(){this.getLayers()._each(function(e){e.unSelectIconInGroup()}),this._selected=!1}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Array.prototype.move=function(e,t){this.splice(t,0,this.splice(e,1)[0])},Array.prototype._each=function(e){for(var t=this.length,i=0;i<t;i++)e.call(this,this[i],i)},t.default=Array},,function(e,t,i){"use strict";var o,n=i(10),r=(o=n)&&o.__esModule?o:{default:o};window.LeafletEditor=(0,r.default)("mapbox")}]);