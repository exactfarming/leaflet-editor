!function(e){var t={};function i(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:s})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=29)}([function(e,t,i){"use strict";i.d(t,"b",function(){return r}),i.d(t,"d",function(){return n}),i.d(t,"a",function(){return a}),i.d(t,"f",function(){return l}),i.d(t,"c",function(){return h}),i.d(t,"e",function(){return d});var s=i(2),o=1;navigator.userAgent.toLowerCase();s.a.isMobileBrowser()&&(o=2);var r=L.divIcon({className:"m-editor-div-icon-first",iconSize:[10*o,10*o]}),n=L.divIcon({className:"m-editor-div-icon",iconSize:[10*o,10*o]}),a=L.divIcon({className:"m-editor-div-icon-drag",iconSize:[10*o*3,10*o*3]}),l=L.divIcon({className:"m-editor-middle-div-icon",iconSize:[10*o,10*o]}),h=n||L.divIcon({className:"m-editor-div-icon",iconSize:[14*o,14*o]}),d=L.divIcon({className:"m-editor-intersection-div-icon",iconSize:[14*o,14*o]})},function(e,t,i){"use strict";t.a=L.Control.extend({options:{position:"topleft",btns:[],eventName:"controlAdded",pressEventName:"btnPressed"},_btn:null,stopEvent:L.DomEvent.stopPropagation,initialize(e){L.Util.setOptions(this,e)},_titleContainer:null,onAdd(e){e.on(this.options.pressEventName,()=>{this._btn&&!L.DomUtil.hasClass(this._btn,"disabled")&&this._onPressBtn()});var t=L.DomUtil.create("div","leaflet-bar leaflet-editor-buttons");e._controlContainer.appendChild(t);var i=this.options,s=this;return setTimeout(()=>{s._setBtn(i.btns,t),i.eventName&&e.fire(i.eventName,{control:s}),L.DomEvent.addListener(s._btn,"mouseover",this._onMouseOver,this),L.DomEvent.addListener(s._btn,"mouseout",this._onMouseOut,this)},1e3),e.getBtnControl=(()=>this),t},_onPressBtn(){},_onMouseOver(){},_onMouseOut(){},_setBtn(e,t){var i,s,o;e.forEach((r,n)=>{n===e.length-1&&(r.className+=" last");var a=document.createElement("div");t.appendChild(a);var l=L.DomUtil.create("a","leaflet-btn",a);l.href="#";var h=L.DomEvent.stopPropagation;L.DomEvent.on(l,"click",h).on(l,"mousedown",h).on(l,"dblclick",h).on(l,"click",L.DomEvent.preventDefault),l.appendChild(L.DomUtil.create("i","fa"+(r.className?" "+r.className:"")));var d=(s=this._map,o=r.pressEventName||this.options.pressEventName,function(){s.fire(o)});L.DomEvent.on(l,"click",L.DomEvent.stopPropagation).on(l,"click",d),i=l}),this._btn=i},getBtnContainer(){return this._map._controlCorners.topleft},getBtnAt(e){return this.getBtnContainer().child[e]},disableBtn(e){L.DomUtil.addClass(this.getBtnAt(e),"disabled")},enableBtn(e){L.DomUtil.removeClass(this.getBtnAt(e),"disabled")}})},function(e,t,i){"use strict";t.a={isMobileBrowser:function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t}}},function(e,t,i){"use strict";var s=i(13);i(4);t.a=L.EditPloygon=s.a.extend({_oldE:void 0,_k:1,_holes:[],initialize(e,t){L.Polyline.prototype.initialize.call(this,e,t),this._initWithHoles(e),this.options.className="leaflet-clickable polygon"},_update(e){var t=e.marker;if(t._mGroup._isHole){var i=t._mGroup._markers;i=i.filter(e=>!e.isMiddle()),this._holes[t._mGroup.position]=i.map(e=>e.getLatLng())}this.redraw()},_removeHole(e){var t=e.marker._mGroup.position;this._holes.splice(t,1),this._map.getEHMarkersGroup().removeLayer(e.marker._mGroup._leaflet_id),this._map.getEHMarkersGroup().repos(e.marker._mGroup.position),this.redraw()},onAdd(e){L.Polyline.prototype.onAdd.call(this,e),e.off("editor:add_marker"),e.on("editor:add_marker",e=>this._update(e)),e.off("editor:drag_marker"),e.on("editor:drag_marker",e=>this._update(e)),e.off("editor:delete_marker"),e.on("editor:delete_marker",e=>this._update(e)),e.off("editor:delete_hole"),e.on("editor:delete_hole",e=>this._removeHole(e)),this.on("mousemove",t=>{e.fire("editor:edit_polygon_mousemove",{layerPoint:t.layerPoint})}),this.on("mouseout",()=>e.fire("editor:edit_polygon_mouseout"))},onRemove(e){this.off("mousemove"),this.off("mouseout"),e.off("editor:edit_polygon_mouseover"),e.off("editor:edit_polygon_mouseout"),L.Polyline.prototype.onRemove.call(this,e)},addHole(e){this._holes=this._holes||[],this._holes.push(e),this.redraw()},hasHoles(){return this._holes.length>0},_resetLastHole(){var e=this._map;e.getSelectedMarker().removeHole(),this._k>.001&&this._addHole(this._oldE,.5)},checkHoleIntersection(){var e=this._map;if(!e.options.allowIntersection&&!e.getEMarkersGroup().isEmpty())for(var t=this._map.getEHMarkersGroup().getLayers(),i=t[t.length-1],s=t[t.length-1].getLayers(),o=0;o<s.length;o++){var r=s[o];if(r._detectIntersectionWithHoles()){this._resetLastHole();break}if(r._isOutsideOfPolygon(this._map.getEMarkersGroup())){this._resetLastHole();break}for(var n=0;n<t.length;n++){var a=t[n];if(i!==a&&a._isMarkerInPolygon(r.getLatLng())){this._resetLastHole();break}}}}})},function(e,t,i){"use strict";L.Class.extend({_time:2e3,initialize(e,t,i){this._map=e,this._popupPane=e._panes.popupPane,this._text=t,this._isStatic=!1,this._container=L.DomUtil.create("div","leaflet-tooltip",this._popupPane),this._render(),this._time=i||this._time},dispose(){this._container&&(this._popupPane.removeChild(this._container),this._container=null)},static(e){return this._isStatic=e||this._isStatic,this},_render(){this._container.innerHTML="<span>"+this._text+"</span>"},_updatePosition(e){var t=this._map.latLngToLayerPoint(e),i=this._container;return this._container&&(i.style.visibility="inherit",L.DomUtil.setPosition(i,t)),this},_showError(e){return this._container&&(L.DomUtil.addClass(this._container,"leaflet-show"),L.DomUtil.addClass(this._container,"leaflet-error-tooltip")),this._updatePosition(e),this._isStatic||this._map.on("mousemove",this._onMouseMove,this),this},_showInfo(e){return this._container&&(L.DomUtil.addClass(this._container,"leaflet-show"),L.DomUtil.addClass(this._container,"leaflet-info-tooltip")),this._updatePosition(e),this._isStatic||this._map.on("mousemove",this._onMouseMove,this),this},_hide(){return this._container&&(L.DomUtil.removeClass(this._container,"leaflet-show"),L.DomUtil.removeClass(this._container,"leaflet-info-tooltip"),L.DomUtil.removeClass(this._container,"leaflet-error-tooltip")),this._map.off("mousemove",this._onMouseMove,this),this},text(e){this._text=e||this._text,this._render()},show(e,t="info"){this.text(),"error"===t&&this.showError(e),"info"===t&&this.showInfo(e)},showInfo(e){this._showInfo(e),this._hideInfoTimeout&&(clearTimeout(this._hideInfoTimeout),this._hideInfoTimeout=null),this._hideInfoTimeout=setTimeout(L.Util.bind(this.hide,this),this._time)},showError(e){this._showError(e),this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null),this._hideErrorTimeout=setTimeout(L.Util.bind(this.hide,this),this._time)},hide(){this._hide()},_onMouseMove(e){this._updatePosition(e.latlng)},setTime(e){e&&(this._time=e)}})},function(e,t,i){"use strict";t.a=L.FeatureGroup.extend({update(){var e=this._map;e._convertToEdit(e.getEMarkersGroup()),e.getEMarkersGroup()._connectMarkers()}})},function(e,t,i){"use strict";var s=i(7);t.a=L.Polyline.extend({options:s.a.style.drawLine,_latlngToMove:void 0,onAdd:function(e){L.Polyline.prototype.onAdd.call(this,e),this.setStyle(e.options.style.drawLine)},addLatLng(e){return this._latlngToMove&&(this._latlngToMove=void 0),this._latlngs.length>1&&this._latlngs.splice(-1),this._latlngs.push(L.latLng(e)),this.redraw()},update(e){return!this._latlngToMove&&this._latlngs.length&&(this._latlngToMove=L.latLng(e),this._latlngs.push(this._latlngToMove)),this._latlngToMove&&(this._latlngToMove.lat=e.lat,this._latlngToMove.lng=e.lng,this.redraw()),this},_addLine(e,t,i){i||e.addTo(t)},clear(){this.setLatLngs([])}})},function(e,t,i){"use strict";t.a={allowIntersection:!1,allowCorrectIntersection:!1,forceToDraw:!0,translations:{removePolygon:"remove polygon",removePoint:"remove point"},overlays:{},defaultControlLayers:!0,style:{view:{opacity:.5,fillOpacity:.2,dashArray:null,clickable:!1,fill:!0,stroke:!0,color:"#00FFFF",weight:3},draw:{opacity:.5,fillOpacity:.2,dashArray:"5, 10",clickable:!0,fill:!0,stroke:!0,color:"#00F800",weight:3},startDraw:{},drawLine:{opacity:.7,fill:!1,fillColor:"#00F800",color:"#00F800",weight:3,dashArray:"5, 10",stroke:!0,clickable:!1}},markerIcon:void 0,markerHoverIcon:void 0,errorLineStyle:{color:"red",weight:3,opacity:1,smoothFactor:1},previewErrorLineStyle:{color:"red",weight:3,opacity:1,smoothFactor:1,dashArray:"5, 10"},text:{intersection:"Self-intersection is prohibited",deletePointIntersection:"Deletion of point is not possible. Self-intersection is prohibited",removePolygon:"Remove polygon",clickToEdit:"click to edit",clickToAddNewEdges:"<div>click&nbsp;&nbsp;<div class='m-editor-middle-div-icon static group-selected'></div>&nbsp;&nbsp;to add new edges</div>",clickToDrawInnerEdges:"click to draw inner edges",clickToJoinEdges:"click to join edges",clickToRemoveAllSelectedEdges:"<div>click&nbsp;&nbsp;&nbsp;&nbsp;<div class='m-editor-div-icon static group-selected'></div>&nbsp;&nbsp;to remove edge&nbsp;&nbsp;or<br>click&nbsp;&nbsp;<i class='fa fa-trash'></i>&nbsp;&nbsp;to remove all selected edges</div>",clickToSelectEdges:"<div>click&nbsp;&nbsp;&nbsp;&nbsp;<div class='m-editor-div-icon static'></div>&nbsp;/&nbsp;<div class='m-editor-middle-div-icon static'></div>&nbsp;&nbsp;to select edges</div>",dblclickToJoinEdges:"double click to join edges",clickToStartDrawPolygonOnMap:"click to start draw polygon on map",deleteSelectedEdges:"deleted selected edges",rejectChanges:"reject changes",jsonWasLoaded:"JSON was loaded",checkJson:"check JSON",loadJson:"load GeoJSON",forgetToSave:"Save changes by pressing outside of polygon",searchLocation:"Search location",submitLoadBtn:"submit",zoom:"Zoom",hideFullScreen:"Hide full screen",showFullScreen:"Show full screen"},worldCopyJump:!0}},function(e,t,i){"use strict";i(4);var s=i(0),o=navigator.userAgent.toLowerCase();-1===o.indexOf("ipad")&&o.indexOf("iphone");var r=!1,n=null;t.a=L.Marker.extend({_draggable:void 0,_oldLatLngState:void 0,initialize(e,t,i={}){i=$.extend({icon:s.d,draggable:!1},i),L.Marker.prototype.initialize.call(this,t,i),this._mGroup=e,this._isFirst=0===e.getLayers().length},removeGroup(){this._mGroup._isHole?this._mGroup.removeHole():this._mGroup.remove()},remove(){this._map&&this._mGroup.removeSelected()},removeHole(){this.removeGroup()},next(){var e=this._next._next;return this._next.isMiddle()||(e=this._next),e},prev(){var e=this._prev._prev;return this._prev.isMiddle()||(e=this._prev),e},changePrevNextPos(){if(this._prev.isMiddle()){var e=this._mGroup._getMiddleLatLng(this.prev(),this),t=this._mGroup._getMiddleLatLng(this,this.next());this._prev.setLatLng(e),this._next.setLatLng(t)}},resetEvents(e){e&&e.call(this)},_posHash(){return this._prev.position+"_"+this.position+"_"+this._next.position},_resetIcon(e){if(!this._hasFirstIcon()){var t=e||s.d;this.setIcon(t),this.prev().setIcon(t),this.next().setIcon(t)}},_setHoverIcon(e){this._hasFirstIcon()||this.setIcon(e||s.c)},_addIconClass(e){L.DomUtil.addClass(this._icon,e)},_removeIconClass(e){L.DomUtil.removeClass(this._icon,e)},_setIntersectionIcon(){var e=s.e.options.className,t="m-editor-div-icon";this._removeIconClass(t),this._addIconClass(e),this._prevIntersected=this.prev(),this._prevIntersected._removeIconClass(t),this._prevIntersected._addIconClass(e),this._nextIntersected=this.next(),this._nextIntersected._removeIconClass(t),this._nextIntersected._addIconClass(e)},_setFirstIcon(){this._isFirst=!0,this.setIcon(s.b)},_hasFirstIcon(){return this._icon&&L.DomUtil.hasClass(this._icon,"m-editor-div-icon-first")},_setMiddleIcon(){this.setIcon(s.f)},isMiddle(){return this._icon&&L.DomUtil.hasClass(this._icon,"m-editor-middle-div-icon")&&!L.DomUtil.hasClass(this._icon,"leaflet-drag-target")},_setDragIcon(){this._removeIconClass("m-editor-div-icon"),this.setIcon(s.a)},isPlain(){return L.DomUtil.hasClass(this._icon,"m-editor-div-icon")||L.DomUtil.hasClass(this._icon,"m-editor-intersection-div-icon")},_onceClick(){this._isFirst&&this.once("click",e=>{if(this._hasFirstIcon()){var t=this._map,i=this._mGroup;if(i._markers.length<3)this._onceClick();else{var o=e.target._latlng;this._map._storedLayerPoint=e.target,i.hasIntersection(o)?this._onceClick():(this._isFirst=!1,this.setIcon(s.d),t.fire("editor:__join_path",{mGroup:i}))}}})},_detectGroupDelete(){let e=this._map;var t=e.getSelectedMGroup();if(this._mGroup._isHole||!this.isPlain()||t&&t.hasFirstMarker())return!1;if(!this.isSelectedInGroup())return n=null,!1;if(n&&this._leaflet_id===n._leaflet_id&&(this._latlng.lat!==n._latlng.lat||this._latlng.lng!==n._latlng.lng))return!1;if(e.options.notifyClickMarkerDeletePolygon&&(t&&!t._isHole&&3===t.getLayers().filter(e=>$(e._icon).hasClass("m-editor-div-icon")).length)){if(n!==this)return n=this,!0;n=null}return!1},isAcceptedToDelete(){return n===this&&this.isSelectedInGroup()},_bindCommonEvents(){this.on("click",e=>{var t=this._map;if(this._detectGroupDelete())t.msgHelper.msg(t.options.text.acceptDeletion,"error",this);else{this._map._storedLayerPoint=e.target;var i=this._mGroup;if(!i.hasFirstMarker()||this===i.getFirst())if(this._hasFirstIcon()&&this._mGroup.hasIntersection(this.getLatLng(),!0))t.edgesIntersected(!1);else if(i.setSelected(this),!this._hasFirstIcon()&&!i.getFirst()._hasFirstIcon()){if(!this.isSelectedInGroup())return i.select(),void(this.isMiddle()?t.msgHelper.msg(t.options.text.clickToAddNewEdges,null,this):t.msgHelper.msg(t.options.text.clickToRemoveAllSelectedEdges,null,this));if(this.isMiddle())i.setMiddleMarkers(this.position),this._resetIcon(s.d),i.select(),t.msgHelper.msg(t.options.text.clickToRemoveAllSelectedEdges,null,this),n=null;else if(!i.getFirst()._hasFirstIcon()&&!r){if(t.msgHelper.hide(),this._detectIntersection({target:{_latlng:i._getMiddleLatLng(this.prev(),this.next())}}))return this.resetStyle(),t._showIntersectionError(t.options.text.deletePointIntersection),void this._previewErrorLine();var o=this.getLatLng(),a=this.next();if(i.removeMarker(this),i.isEmpty())i._isHole?t.fire("editor:polygon:hole_deleted"):t.fire("editor:polygon:deleted"),t.msgHelper.hide();else{var l=a._prev.getLatLng();l.lat===o.lat&&l.lng===o.lng&&t.msgHelper.msg(t.options.text.clickToAddNewEdges,null,a._prev),i.setSelected(a)}i.select()}}}}),this.on("mouseover",()=>{var e=this._map;this._mGroup.getFirst()._hasFirstIcon()?this._mGroup.getLayers().length>2&&(this._hasFirstIcon()?e.fire("editor:first_marker_mouseover",{marker:this}):this===this._mGroup._lastMarker&&e.fire("editor:last_marker_dblclick_mouseover",{marker:this})):this.isSelectedInGroup()?this.isMiddle()?e.fire("editor:selected_middle_marker_mouseover",{marker:this}):e.fire("editor:selected_marker_mouseover",{marker:this}):e.fire("editor:not_selected_marker_mouseover",{marker:this}),this.isAcceptedToDelete()&&e.msgHelper.msg(e.options.text.acceptDeletion,"error",this)}),this.on("mouseout",()=>{this._map.fire("editor:marker_mouseout")}),this._onceClick(),this.on("dblclick",()=>{var e=this._mGroup;e&&e.getFirst()&&e.getFirst()._hasFirstIcon()&&this===e._lastMarker&&e.getFirst().fire("click")}),this.on("drag",e=>{e.target.changePrevNextPos();var t=this._map;t._convertToEdit(t.getEMarkersGroup()),this._setDragIcon(),t.fire("editor:drag_marker",{marker:this})}),this.on("dragend",()=>{this._mGroup.select(),this._map.fire("editor:dragend_marker",{marker:this}),r=!0,setTimeout(()=>{r=!1},200),this._map.fire("editor:selected_marker_mouseover",{marker:this})})},_isInsideHole(){for(var e=this._map,t=e.getEHMarkersGroup().getLayers(),i=0;i<t.length;i++){var s=t[i];if(this._mGroup!==s&&s._isMarkerInPolygon(this.getLatLng()))return!0}return!1},_isOutsideOfPolygon(e){return!e._isMarkerInPolygon(this.getLatLng())},_detectIntersection(e){var t=this._map;if(!t.options.allowIntersection){var i=void 0===e?this.getLatLng():e.target._latlng,s=!1,o=!1;this._mGroup._isHole?(s=this._isOutsideOfPolygon(t.getEMarkersGroup()),o=this._isInsideHole()):o=this._isInsideHole();var r=o||s||this._mGroup.hasIntersection(i)||this._detectIntersectionWithHoles(e);return t.edgesIntersected(r),r&&this._map._showIntersectionError(),t.edgesIntersected()}},_detectIntersectionWithHoles(e){var t,i=this._map,s=!1,o=void 0===e?this.getLatLng():e.target._latlng,r=i.getEHMarkersGroup().getLayers(),n=i.getEMarkersGroup(),a=this.prev(),l=this.next();if(null!=a||null!=l){var h,d=a.getLatLng(),_=l.getLatLng(),c=[];if(this._mGroup._isHole){for(var p=0;p<r.length;p++)if((t=r[p])!==this._mGroup){if(s=this._mGroup.hasIntersectionWithHole([o,d,_],t))return s;if(c=[],(h=t.getLayers())._each(e=>{this._mGroup._isMarkerInPolygon(e.getLatLng())&&c.push("")}),c.length===h.length)return!0}return this._mGroup.hasIntersectionWithHole([o,d,_],n)}for(p=0;p<r.length;p++){if(s=this._mGroup.hasIntersectionWithHole([o,d,_],r[p]))return s;c=[],h=r[p].getLayers();for(var m=0;m<h.length;m++)h[m]._isOutsideOfPolygon(n)&&c.push("");if(c.length===h.length)return!0}return s}},onAdd(e){L.Marker.prototype.onAdd.call(this,e),this.on("dragstart",e=>{this._storedLayerPoint=null,this._mGroup.setSelected(this),this._oldLatLngState=e.target._latlng,this._prev.isPlain()&&this._mGroup.setMiddleMarkers(this.position)}).on("drag",e=>{this._onDrag(e)}).on("dragend",e=>{this._onDragEnd(e)}),this.on("mousedown",()=>{if(!this.dragging._enabled)return!1}),this._bindCommonEvents(e)},_onDrag(e){this._detectIntersection(e)},_onDragEnd(e){var t=this._detectIntersection(e);t&&!this._map.options.allowCorrectIntersection&&this._restoreOldPosition()},_restoreOldPosition(){var e=this._map;if(e.edgesIntersected()){let t=this._oldLatLngState;this.setLatLng(L.latLng(t.lat,t.lng)),this.changePrevNextPos(),e._convertToEdit(e.getEMarkersGroup()),e.fire("editor:drag_marker",{marker:this}),this._oldLatLngState=void 0,this.resetStyle()}else this._oldLatLngState=this.getLatLng()},_animateZoom(e){if(this._map){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(t)}},resetIcon(){this._removeIconClass("m-editor-intersection-div-icon"),this._removeIconClass("m-editor-div-icon-drag")},unSelectIconInGroup(){this._removeIconClass("group-selected")},_selectIconInGroup(){this.isMiddle()||this._addIconClass("m-editor-div-icon"),this._addIconClass("group-selected")},selectIconInGroup(){this._prev&&this._prev._selectIconInGroup(),this._selectIconInGroup(),this._next&&this._next._selectIconInGroup()},isSelectedInGroup(){return L.DomUtil.hasClass(this._icon,"group-selected")},onRemove(e){this.off("mouseout"),L.Marker.prototype.onRemove.call(this,e)},_errorLines:[],_prevErrorLine:null,_nextErrorLine:null,_drawErrorLines(){var e=this._map;this._clearErrorLines();var t=this.getLatLng(),i=[this.prev().getLatLng(),t],s=[this.next().getLatLng(),t],o=this._map.options.errorLineStyle;this._prevErrorLine=new L.Polyline(i,o),this._nextErrorLine=new L.Polyline(s,o),this._prevErrorLine.addTo(e),this._nextErrorLine.addTo(e),this._errorLines.push(this._prevErrorLine),this._errorLines.push(this._nextErrorLine)},_clearErrorLines(){this._errorLines._each(e=>this._map.removeLayer(e))},setIntersectedStyle(){this._setIntersectionIcon(),this._drawErrorLines()},resetStyle(){this.resetIcon(),this.selectIconInGroup(),this._prevIntersected&&(this._prevIntersected.resetIcon(),this._prevIntersected.selectIconInGroup()),this._nextIntersected&&(this._nextIntersected.resetIcon(),this._nextIntersected.selectIconInGroup()),this._prevIntersected=null,this._nextIntersected=null,this._clearErrorLines()},_previewErLine:null,_pt:null,_previewErrorLine(){this._previewErLine&&this._map.removeLayer(this._previewErLine),this._pt&&clearTimeout(this._pt);var e=[this.next().getLatLng(),this.prev().getLatLng()],t=this._map.options.previewErrorLineStyle;this._previewErLine=new L.Polyline(e,t),this._previewErLine.addTo(this._map),this._pt=setTimeout(()=>{this._map.removeLayer(this._previewErLine)},900)}})},function(e,t,i){"use strict";t.a=function(e={},t=[]){var i,s=e,o=function(e,r){var n=s[e].position;void 0!==n&&(n!==r&&(i=s[e],s[e]=s[t[n]],s[t[n]]=i),n!=r&&o.call(null,e,r))};return t.forEach(o),s}},function(e,t,i){"use strict";var s=i(11),o=i(15),r=i(22),n=i(7);i(28);t.a=function(e){let t=("mapbox"===e?L.mapbox.Map:L.Map).extend($.extend(s.a,{$:void 0,initialize(t,i){i.text&&($.extend(n.a.text,i.text),delete i.text);let s=i.controls;s&&!1===s.zoom&&(i.zoomControl=!1),i.style&&(i.style.draw&&$.extend(n.a.style.draw,i.style.draw),i.style.view&&$.extend(n.a.style.view,i.style.view),i.style.startDraw&&$.extend(n.a.style.startDraw,i.style.startDraw),i.style.drawLine&&$.extend(n.a.style.drawLine,i.style.drawLine),delete i.style),$.extend(this.options,n.a,i),"mapbox"===e?L.mapbox.Map.prototype.initialize.call(this,t,this.options.mapboxId,this.options):L.Map.prototype.initialize.call(this,t,this.options),this.$=$(this._container),r.a.setLayers(),this._addLayers([r.a.viewGroup,r.a.editGroup,r.a.editPolygon,r.a.editMarkersGroup,r.a.editLineGroup,r.a.dashedEditLineGroup,r.a.editHoleMarkersGroup]),this._setOverlays(i),this.options.forceToDraw&&this.mode("draw")},_setOverlays(e){var t=e.overlays;for(var i in t){var s=t[i];this._controlLayers.addOverlay(s,i),s.addTo(this),s.bringToBack(),s.on("click",function(){return!1}),s.on("mouseup",function(){return!1})}},getVGroup:()=>r.a.viewGroup,getEGroup:()=>r.a.editGroup,getEPolygon:()=>r.a.editPolygon,getEMarkersGroup:()=>r.a.editMarkersGroup,getELineGroup:()=>r.a.editLineGroup,getDELine:()=>r.a.dashedEditLineGroup,getEHMarkersGroup:()=>r.a.editHoleMarkersGroup,getSelectedPolygon:()=>this._selectedPolygon,getSelectedMGroup(){return this._selectedMGroup}}));return t.addInitHook(o.a),t}},function(e,t,i){"use strict";var s=i(12),o=i(3),r=i(14);t.a=$.extend({_selectedMarker:void 0,_selectedVLayer:void 0,_oldSelectedMarker:void 0,__polygonEdgesIntersected:!1,_modeType:"draw",_controlLayers:void 0,_getSelectedVLayer(){return this._selectedVLayer},_setSelectedVLayer(e){this._selectedVLayer=e},_clearSelectedVLayer(){this._selectedVLayer=void 0},_hideSelectedVLayer(e){e.bringToBack(),e&&(this._showSelectedVLayer(this._getSelectedVLayer()),this._setSelectedVLayer(e),e._path.style.visibility="hidden")},_showSelectedVLayer(e=this._selectedVLayer){e&&(e._path.style.visibility="")},hasSelectedVLayer(){return void 0!==this._getSelectedVLayer()},_addEGroup_To_VGroup(){let e=this.getVGroup(),t=this.getEGroup();t.eachLayer(t=>{if(!t.isEmpty()){let i=t._holes,s=t.getLatLngs();$.isArray(i)&&i&&(s=[s].concat(i)),e.addLayer(L.polygon(s))}})},_addEPolygon_To_VGroup(){let e=this.getVGroup(),t=this.getEPolygon(),i=t.getHoles(),s=t.getLatLngs();s.length<=2||($.isArray(i)&&i&&(s=[s].concat(i)),e.addLayer(L.polygon(s)))},_setEPolygon_To_VGroup(){let e=this.getEPolygon(),t=this._getSelectedVLayer();t&&(t._latlngs=e.getLatLngs(),t._holes=e.getHoles(),t.redraw())},_convert_EGroup_To_VGroup(){this.getVGroup().clearLayers(),this._addEGroup_To_VGroup()},_convertToEdit(e){if(e instanceof L.MultiPolygon){let t=this.getEGroup();return t.clearLayers(),e.eachLayer(e=>{let i=e.getLatLngs(),s=e._holes;$.isArray(s)&&(i=[i].concat(s));let r=new o.a(i);r.addTo(this),t.addLayer(r)}),t}if(e instanceof L.MarkerGroup){let t=this.getEPolygon(),i=e.getLayers(),s=(i=i.filter(e=>!e.isMiddle())).map(e=>e.getLatLng()),o=t.getHoles();return o&&(s=[s].concat(o)),t.setLatLngs(s),t.redraw(),t}},_setMode(e){let t=this.options;this.getEPolygon().setStyle(t.style[e])},_getModeType(){return this._modeType},_setModeType(e){this.$.removeClass("map-"+this._modeType),this._modeType=e,this.$.addClass("map-"+this._modeType)},_setMarkersGroupIcon(e){let t=this.options.markerIcon,i=this.options.markerHoverIcon,s=this._getModeType();if(t)if(t.mode){let i=t.mode[s];void 0!==i&&(e.options.mIcon=i)}else e.options.mIcon=t;if(i)if(i.mode){let t=i[s];void 0!==t&&(e.options.mHoverIcon=t)}else e.options.mHoverIcon=i;e.options.mHoverIcon=e.options.mHoverIcon||e.options.mIcon,"afterDraw"===s&&e.updateStyle()},mode(e){if(this.fire(this._modeType+"_events_disable"),this.fire(e+"_events_enable"),this._setModeType(e),void 0===e)return this._modeType;this._clearEvents(),e=this[e]()||e,this._setMode(e)},isMode(e){return e===this._modeType},draw(){(this.isMode("edit")||this.isMode("view")||this.isMode("afterDraw"))&&this._clearMap(),this._bindDrawEvents()},cancel(){this._clearMap(),this.mode("view")},clear(){this._clearEvents(),this._clearMap(),this.fire("editor:map_cleared")},clearAll(){this.mode("view"),this.clear(),this.getVGroup().clearLayers()},saveState(){let e=_map.getEPolygon();e.isEmpty()||(this._getSelectedVLayer()?this._setEPolygon_To_VGroup():this._addEPolygon_To_VGroup()),this.clear(),this.mode("draw");let t=this.getVGroup().toGeoJSON();return t.geometry?t.geometry:{}},area(e){let{precLatLng:t}=e||{precLatLng:2};if(!window.turf)return console.error('leaflet-editor: no "turf" library!!! http://turfjs.org/'),0;let i=this.getVGroup(),s=this.getEPolygon(),o=this._getSelectedVLayer(),n=0;if(!s.isEmpty()){let e=turf.area(Object(r.b)(s.toGeoJSON(),t)),a=turf.area(Object(r.b)(i.toGeoJSON(),t)),l=o?turf.area(Object(r.b)(o.toGeoJSON(),t)):0;this.hasSelectedVLayer()&&e>0&&(a-=l),n=e>0?a+e:a}return Object(r.a)(n,t)},getSelectedMarker(){return this._selectedMarker},clearSelectedMarker(){this._selectedMarker=null},removeSelectedMarker(){let e=this._selectedMarker,t=e.prev(),i=e.next(),s=e._middlePrev,o=e._middleNext;e.remove(),this._selectedMarker=s,this._selectedMarker.remove(),this._selectedMarker=o,this._selectedMarker.remove(),t._middleNext=null,i._middlePrev=null},removePolygon(e){this.getEMarkersGroup().clearLayers(),this.getEHMarkersGroup().clearLayers(),e.clear(),this.isMode("afterDraw")&&this.mode("draw"),this.clearSelectedMarker(),this._setEPolygon_To_VGroup()},createEditPolygon(e){let t=L.geoJson(e);this._getSelectedVLayer()?this._setEPolygon_To_VGroup():this._addEPolygon_To_VGroup(),this.clear();let i=t.getLayers()[0];if(i){let e=i.getLayers(),t=this.getVGroup();for(let i=0;i<e.length;i++){let s=e[i];t.addLayer(s)}}this.mode("draw"),this._fitVBounds()},moveMarker(e){this.getEMarkersGroup().getSelected().setLatLng(e)},_fitVBounds(){0!==this.getVGroup().getLayers().length&&this.fitBounds(this.getVGroup().getBounds(),{padding:[30,30]})},_clearMap(){this.getEGroup().clearLayers(),this.getEPolygon().clear(),this.getEMarkersGroup().clear();let e=this.getSelectedMGroup();e&&e.getDELine().clear(),this.getEHMarkersGroup().clearLayers(),this._activeEditLayer=void 0,this._showSelectedVLayer(),this._clearSelectedVLayer(),this.clearSelectedMarker()},_clearEvents(){this._unBindDrawEvents()},_activeEditLayer:void 0,_setActiveEditLayer(e){this._activeEditLayer=e},_getActiveEditLayer(){return this._activeEditLayer},_clearActiveEditLayer(){this._activeEditLayer=null},_setEHMarkerGroup(e){let t=new L.MarkerGroup;t._isHole=!0,this._setMarkersGroupIcon(t);let i=this.getEHMarkersGroup();t.addTo(i);let s=i.getLayers(),o=s.length-1;t._position=o;for(let i=0;i<e.length;i++)t.setHoleMarker(e[i],void 0,{},{hGroup:o,hMarker:i});let r=t.getLayers();r.map((e,i)=>{t._setMiddleMarkers(e,i)});let n=this.getEPolygon();return(r=t.getLayers()).forEach(e=>{n.updateHolePoint(o,e.__position,e._latlng)}),t},_moveEPolygonOnTop(){let e=this.getEPolygon();if(e._container){let t=$(e._container.parentNode).children().last(),i=$(e._container);i[0]!==t&&i.detach().insertAfter(t)}},restoreEPolygon(e){if(!(e=e||this.getEPolygon()))return;let t=e.getLatLngs();this.getEMarkersGroup().setAll(t);let i=e.getHoles();if(i)for(let e=0;e<i.length;e++)this._setEHMarkerGroup(i[e])},getControlLayers:()=>this._controlLayers,edgesIntersected(e){if(void 0===e)return this.__polygonEdgesIntersected;this.__polygonEdgesIntersected=e,!0===e?this.fire("editor:intersection_detected",{intersection:!0}):this.fire("editor:intersection_detected",{intersection:!1})},_errorTimeout:null,_showIntersectionError(e){this._errorTimeout&&clearTimeout(this._errorTimeout),this.msgHelper.msg(e||this.options.text.intersection,"error",this._storedLayerPoint||this.getSelectedMarker()),this._storedLayerPoint=null,this._errorTimeout=setTimeout(()=>{this.msgHelper.hide()},1e4)}},s.a)},function(e,t,i){"use strict";var s=i(0);t.a={_bindDrawEvents(){this._unBindDrawEvents(),this.on("click",e=>{if(this._storedLayerPoint=e.layerPoint,!(e.originalEvent&&0===e.originalEvent.clientX&&0===e.originalEvent.clientY||e.target instanceof L.Marker)){var t=e.target.getEMarkersGroup();if(t.isEmpty()){this._addMarker(e),this.fire("editor:start_add_new_polygon");var i=this.options.style.startDraw;return i&&this.getEPolygon().setStyle(i),this._clearSelectedVLayer(),this._selectedMGroup=t,!1}var o=t.getFirst();if(o&&o._hasFirstIcon())return e.target instanceof L.Marker||this._addMarker(e),!1;var r=this.getEHMarkersGroup(),n=r.getLastHole();if(o&&!o._hasFirstIcon()&&!(e.target.getEPolygon()._path!==e.originalEvent.target||n&&n.getFirst()&&n.getFirst()._hasFirstIcon())){this.clearSelectedMarker();var a=r.addHoleGroup();return a.set(e.latlng,null,{icon:s.b}),this._selectedMGroup=a,this.fire("editor:start_add_new_hole"),!1}if(n&&!n.isEmpty()&&n.hasFirstMarker()){if(this.getEMarkersGroup()._isMarkerInPolygon(e.latlng))r.getLastHole().set(e.latlng)._detectIntersection()&&this._showIntersectionError();else this._showIntersectionError();return!1}this._getSelectedVLayer()?this._setEPolygon_To_VGroup():this._addEPolygon_To_VGroup(),this.clear(),this.mode("draw"),this.fire("editor:marker_group_clear")}}),this.on("editor:__join_path",e=>{var t=e.mGroup;if(t){t._isHole&&this.getEHMarkersGroup().resetLastHole();var i=-1;t.getLayers().forEach(()=>{var e=t.addMarker(i,null,{icon:s.f});i=e.position+2}),t.getDELine().clear(),t.getLayers()._each(e=>{e.dragging.enable()}),t.select(),this.getEPolygon().setStyle(this.options.style.draw),t._isHole?this.fire("editor:polygon:hole_created"):this.fire("editor:polygon:created")}});var e=this.getVGroup();e.on("click",t=>{e.onClick(t),this.msgHelper.msg(this.options.text.clickToDrawInnerEdges,null,t.layerPoint),this.fire("editor:polygon:selected")}),this.on("editor:delete_marker",()=>{this._convertToEdit(this.getEMarkersGroup())}),this.on("editor:delete_polygon",()=>{this.getEHMarkersGroup().remove()})},_addMarker(e){var t=e.latlng,i=this.getEMarkersGroup(),s=i.set(t);return this._convertToEdit(i),s},_updateDELine(e){return this.getEMarkersGroup().getDELine().update(e)},_unBindDrawEvents(){this.off("click"),this.getVGroup().off("click"),this.off("dblclick"),this.getDELine().clear(),this.off("editor:__join_path"),this._openPopup&&(this.openPopup=this._openPopup,delete this._openPopup)}}},function(e,t,i){"use strict";t.a=L.Polygon.extend({isEmpty(){var e=this.getLatLngs();return null===e||void 0===e||e&&0===e.length},getHole(e){if($.isNumeric(e))return this._holes[e]},getHolePoint(e,t){if($.isNumeric(e)||$.isNumeric(t))return this._holes[e][t]},getHoles(){return this._holes},clearHoles(){this._holes=[],this.redraw()},clear(){this.clearHoles(),$.isArray(this._latlngs)&&void 0!==this._latlngs[0]&&this.setLatLngs([])},updateHolePoint(e,t,i){return $.isNumeric(e)&&$.isNumeric(t)?this._holes[e][t]=i:$.isNumeric(e)&&!$.isNumeric(t)?this._holes[e]=i:this._holes=i,this},setHoles(e){this._holes=e},setHolePoint(e,t,i){var s=this.getLayers()[0];return s&&$.isNumeric(e)&&$.isNumeric(t)&&(s._holes[e][t]=i),this}})},function(e,t,i){"use strict";const s=function(e,t){let i=`${e}`.split(".");if(t=t||0,!e||1===i.length)return e;let s=0;if(i[1].length>0){let o=i[1].length<t?i[1].length:t;s=e.toPrecision(i[0].length+o)}return Number(s)};t.a=s;t.b=function(e,t=0){let i;if(null===e||void 0===e)throw new Error("Please, make sure that first arguments is geoJSON");i=JSON.parse(JSON.stringify(e));let{geometry:{type:o,coordinates:r}}=i;if(!Array.isArray(r))throw new Error("Please, make sure that geoJSON has correct structure");return"Polygon"===o&&t>0&&r.forEach(e=>{e.forEach(e=>{e[0]=s(e[0],t),e[1]=s(e[1],t)})}),"MultiPolygon"===o&&t>0&&r.forEach(e=>{e.forEach(e=>{e.forEach(e=>{e[0]=s(e[0],t),e[1]=s(e[1],t)})})}),i}},function(e,t,i){"use strict";var s=i(16),o=i(17),r=i(18),n=i(1),a=i(19),l=i(2),h=i(20),d=i(21);t.a=function(){if(Object(h.a)(this),Object(d.a)(this),this.options.defaultControlLayers){var e=L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'});this.addLayer(e),this._controlLayers=new L.Control.Layers({Google:new L.Google,OSM:e}),this.addControl(this._controlLayers)}this.touchZoom.disable(),this.doubleClickZoom.disable(),this.boxZoom.disable(),this.keyboard.disable();var t=this.options.controls;t&&t.geoSearch&&this.addControl(new s.a),this._BtnControl=n.a;var i=new o.a({btns:[{className:"fa fa-trash"}]});let _;t&&t.loadBtn&&(_=new r.a({btns:[{className:"fa fa-arrow-circle-o-down load"}]}));var c=this.msgHelper=new a.a({defaultMsg:this.options.text.clickToStartDrawPolygonOnMap});this.on("msgHelperAdded",()=>{var e=this.options.text;this.on("editor:marker_group_select",()=>{this.off("editor:not_selected_marker_mouseover"),this.on("editor:not_selected_marker_mouseover",t=>{c.msg(e.clickToSelectEdges,null,t.marker)}),this.off("editor:selected_marker_mouseover"),this.on("editor:selected_marker_mouseover",t=>{c.msg(e.clickToRemoveAllSelectedEdges,null,t.marker)}),this.off("editor:selected_middle_marker_mouseover"),this.on("editor:selected_middle_marker_mouseover",t=>{c.msg(e.clickToAddNewEdges,null,t.marker)}),this.off("editor:edit_polygon_mousemove"),this.on("editor:edit_polygon_mousemove",t=>{c.msg(e.clickToDrawInnerEdges,null,t.layerPoint)}),this.off("editor:edit_polygon_mouseout"),this.on("editor:edit_polygon_mouseout",()=>{c.hide(),this._storedLayerPoint=null}),this.off("editor:view_polygon_mousemove"),this.on("editor:view_polygon_mousemove",t=>{c.msg(e.clickToEdit,null,t.layerPoint)}),this.off("editor:view_polygon_mouseout"),this.on("editor:view_polygon_mouseout",()=>{c.hide(),this._storedLayerPoint=null})}),this.off("editor:marker_mouseout"),this.on("editor:marker_mouseout",()=>{c.hide()}),this.off("editor:first_marker_mouseover"),this.on("editor:first_marker_mouseover",t=>{c.msg(e.clickToJoinEdges,null,t.marker)}),this.off("editor:last_marker_dblclick_mouseover"),this.on("editor:last_marker_dblclick_mouseover",t=>{c.msg(e.dblclickToJoinEdges,null,t.marker)}),this.on("editor:__join_path",e=>{e.marker&&c.msg(this.options.text.clickToRemoveAllSelectedEdges,null,e.marker)}),this.on("editor:intersection_detected",e=>{e.intersection?(c.msg(this.options.text.intersection,"error",this._storedLayerPoint||this.getSelectedMarker()),this._storedLayerPoint=null):c.hide();var t=this.getSelectedMarker();this.hasLayer(t)&&(t&&!t._mGroup.hasFirstMarker()&&(e.intersection?t.setIntersectedStyle():(t.resetStyle(),t._mGroup.getLayers().filter(e=>L.DomUtil.hasClass(e._icon,"m-editor-intersection-div-icon")).map(e=>e.resetStyle()))))})}),l.a.isMobileBrowser()||(this.addControl(c),t&&t.loadBtn&&this.addControl(_)),t&&t.trashBtn&&this.addControl(i)}},function(e,t,i){"use strict";t.a=L.Control.extend({options:{position:"topleft",email:""},onAdd(e){this._map=e;var t=L.DomUtil.create("div","leaflet-bar leaflet-search-bar"),i=document.createElement("div");t.appendChild(i);var s=L.DomUtil.create("a","",i);s.href="#";var o=L.DomEvent.stopPropagation;L.DomEvent.on(s,"click",o).on(s,"mousedown",o).on(s,"dblclick",o).on(s,"click",L.DomEvent.preventDefault).on(s,"click",this._toggle,this),s.appendChild(L.DomUtil.create("i","fa fa-search"));var r=this._form=document.createElement("form");L.DomEvent.on(r,"mousewheel",o),L.DomEvent.on(r,"DOMMouseScroll",o),L.DomEvent.on(r,"MozMousePixelScroll",o);var n=this._input=document.createElement("input");L.DomEvent.on(n,"click",o).on(n,"mousedown",o),r.appendChild(n);var a=this._submitBtn=L.DomUtil.create("button","leaflet-submit-btn search");return a.type="submit",L.DomEvent.on(a,"click",o).on(a,"mousedown",o).on(a,"click",this._doSearch,this),r.appendChild(a),this._btnTextContainer=L.DomUtil.create("span","text"),this._btnTextContainer.innerHTML=this._map.options.text.submitLoadBtn,a.appendChild(this._btnTextContainer),this._spinIcon=L.DomUtil.create("i","fa fa-refresh fa-spin"),a.appendChild(this._spinIcon),L.DomEvent.on(r,"submit",o).on(r,"submit",L.DomEvent.preventDefault),t.appendChild(r),this._map.on("loadBtnOpened",this._collapse,this),L.DomEvent.addListener(t,"mouseover",this._onMouseOver,this),L.DomEvent.addListener(t,"mouseout",this._onMouseOut,this),this._titleContainer=L.DomUtil.create("div","btn-leaflet-msg-container title-hidden"),this._titleContainer.innerHTML=this._map.options.text.searchLocation,t.appendChild(this._titleContainer),t},_toggle(){"block"!=this._form.style.display?(this._form.style.display="block",this._input.focus(),this._map.fire("searchEnabled")):(this._collapse(),this._map.fire("searchDisabled")),L.DomUtil.addClass(this._titleContainer,"title-hidden")},_collapse(){this._form.style.display="none",this._input.value=""},_nominatimCallback(e){this._results&&this._results.parentNode&&this._results.parentNode.removeChild(this._results);var t=this._results=document.createElement("div");t.style.height="80px",t.style.overflowY="auto",t.style.overflowX="hidden",t.style.backgroundColor="white",t.style.margin="3px",t.style.padding="2px",t.style.border="2px grey solid",t.style.borderRadius="2px",L.DomEvent.on(t,"mousedown",L.DomEvent.stopPropagation),L.DomEvent.on(t,"mousewheel",L.DomEvent.stopPropagation),L.DomEvent.on(t,"DOMMouseScroll",L.DomEvent.stopPropagation),L.DomEvent.on(t,"MozMousePixelScroll",L.DomEvent.stopPropagation);for(var i=[],s=0;s<e.length;s++){var o=L.DomUtil.create("div","search-results-el");o.innerHTML=e[s].display_name,o.title=e[s].display_name,t.appendChild(o);var r=function(e,t,s){return function(){for(var o=0;o<i.length;o++)L.DomUtil.removeClass(i[o],"selected");L.DomUtil.addClass(s,"selected");var r=t.boundingbox;e.fitBounds(L.latLngBounds([[r[0],r[2]],[r[1],r[3]]]))}}(this._map,e[s],o);L.DomEvent.on(o,"click",L.DomEvent.stopPropagation),L.DomEvent.on(o,"mousewheel",L.DomEvent.stopPropagation),L.DomEvent.on(o,"MozMousePixelScroll",L.DomEvent.stopPropagation),L.DomEvent.on(o,"DOMMouseScroll",L.DomEvent.stopPropagation).on(o,"click",r),i.push(o)}this._form.appendChild(t),0===e.length&&this._results.parentNode.removeChild(this._results),L.DomUtil.removeClass(this._submitBtn,"loading")},_callbackId:0,_doSearch(){L.DomUtil.addClass(this._submitBtn,"loading");var e="_l_osmgeocoder_"+this._callbackId++;window[e]=L.Util.bind(this._nominatimCallback,this);var t={q:this._input.value,format:"json",limit:10,json_callback:e};this.options.email&&(t.email=this.options.email),this._map.getBounds()&&(t.viewbox=this._map.getBounds().toBBoxString());var i="http://nominatim.openstreetmap.org/search"+L.Util.getParamString(t),s=document.createElement("script");s.type="text/javascript",s.src=i,document.getElementsByTagName("head")[0].appendChild(s)},_onMouseOver(){"block"!==this._form.style.display&&L.DomUtil.removeClass(this._titleContainer,"title-hidden")},_onMouseOut(){L.DomUtil.addClass(this._titleContainer,"title-hidden")}})},function(e,t,i){"use strict";var s=i(1);t.a=s.a.extend({options:{eventName:"trashAdded",pressEventName:"trashBtnPressed"},_btn:null,onAdd(e){e.on("trashAdded",t=>{L.DomUtil.addClass(t.control._btn,"disabled"),e.on("editor:marker_group_select",this._bindEvents,this),e.on("editor:start_add_new_polygon",this._bindEvents,this),e.on("editor:start_add_new_hole",this._bindEvents,this),e.on("editor:marker_group_clear",this._disableBtn,this),e.on("editor:delete_polygon",this._disableBtn,this),e.on("editor:delete_hole",this._disableBtn,this),e.on("editor:map_cleared",this._disableBtn,this),this._disableBtn()});var t=s.a.prototype.onAdd.call(this,e);return this._titleContainer=L.DomUtil.create("div","btn-leaflet-msg-container title-hidden"),this._titleContainer.innerHTML=this._map.options.text.loadJson,t.appendChild(this._titleContainer),t},_bindEvents(){L.DomUtil.removeClass(this._btn,"disabled"),L.DomEvent.addListener(this._btn,"mouseover",this._onMouseOver,this),L.DomEvent.addListener(this._btn,"mouseout",this._onMouseOut,this),L.DomEvent.addListener(this._btn,"click",this._onPressBtn,this)},_disableBtn(){L.DomUtil.addClass(this._btn,"disabled"),L.DomEvent.removeListener(this._btn,"mouseover",this._onMouseOver),L.DomEvent.removeListener(this._btn,"mouseout",this._onMouseOut),L.DomEvent.removeListener(this._btn,"click",this._onPressBtn,this)},_onPressBtn(){var e=this._map,t=e.getSelectedMGroup();t===e.getEMarkersGroup()&&t.getLayers()[0]._isFirst?(e.clear(),e.mode("draw")):(t.remove(),t.getDELine().clear(),L.DomUtil.addClass(this._btn,"disabled"),e.fire("editor:polygon:deleted")),this._onMouseOut(),L.DomUtil.addClass(this._titleContainer,"title-hidden")},_onMouseOver(){if(!L.DomUtil.hasClass(this._btn,"disabled")){var e=this._map,t=e.getEMarkersGroup().getLayers()[0];t&&t._isFirst?this._titleContainer.innerHTML=e.options.text.rejectChanges:this._titleContainer.innerHTML=e.options.text.deleteSelectedEdges,L.DomUtil.removeClass(this._titleContainer,"title-hidden")}},_onMouseOut(){L.DomUtil.hasClass(this._btn,"disabled")||L.DomUtil.addClass(this._titleContainer,"title-hidden")}})},function(e,t,i){"use strict";var s=i(1);t.a=s.a.extend({options:{eventName:"loadBtnAdded",pressEventName:"loadBtnPressed"},onAdd(e){var t=s.a.prototype.onAdd.call(this,e);return e.on("loadBtnAdded",()=>{this._map.on("searchEnabled",this._collapse,this),this._renderForm(t)}),L.DomUtil.addClass(t,"load-json-container"),t},_onPressBtn(){this._timeout&&clearTimeout(this._timeout),L.DomUtil.addClass(this._titleContainer,"title-hidden"),"block"!=this._form.style.display?(this._form.style.display="block",this._textarea.focus(),this._map.fire("loadBtnOpened")):(this._collapse(),this._map.fire("loadBtnHidden"))},_collapse(){this._form.style.display="none",this._textarea.value=""},_renderForm(e){var t=this._form=L.DomUtil.create("form"),i=this._textarea=L.DomUtil.create("textarea");i.style.width="200px",i.style.height="100px",i.style.border="1px solid white",i.style.padding="5px",i.style.borderRadius="4px",L.DomEvent.on(i,"click",this.stopEvent).on(i,"mousedown",this.stopEvent).on(i,"dblclick",this.stopEvent).on(i,"mousewheel",this.stopEvent),t.appendChild(i);var s=this._submitBtn=L.DomUtil.create("button","leaflet-submit-btn load-geojson");s.type="submit",s.innerHTML=this._map.options.text.submitLoadBtn,L.DomEvent.on(s,"click",this.stopEvent).on(s,"mousedown",this.stopEvent).on(s,"click",this._submitForm,this),t.appendChild(s),L.DomEvent.on(t,"submit",L.DomEvent.preventDefault),e.appendChild(t),this._titleContainer=L.DomUtil.create("div","btn-leaflet-msg-container title-hidden"),this._titleContainer.innerHTML=this._map.options.text.loadJson,e.appendChild(this._titleContainer)},_timeout:null,_submitForm(){var e;this._timeout&&clearTimeout(this._timeout);var t=this._map;try{e=JSON.parse(this._textarea.value),L.DomUtil.removeClass(this._titleContainer,"title-hidden"),L.DomUtil.removeClass(this._titleContainer,"title-error"),L.DomUtil.addClass(this._titleContainer,"title-success"),this._titleContainer.innerHTML=t.options.text.jsonWasLoaded,t.createEditPolygon(e),this._timeout=setTimeout(()=>{L.DomUtil.addClass(this._titleContainer,"title-hidden")},2e3),this._collapse(),this._map.fire("loadBtnHidden")}catch(e){L.DomUtil.removeClass(this._titleContainer,"title-hidden"),L.DomUtil.addClass(this._titleContainer,"title-error"),L.DomUtil.removeClass(this._titleContainer,"title-success"),this._titleContainer.innerHTML=t.options.text.checkJson,this._timeout=setTimeout(()=>{L.DomUtil.addClass(this._titleContainer,"title-hidden")},2e3),this._collapse(),this._map.fire("loadBtnHidden"),this._map.mode("draw")}},_onMouseOver(){"block"!==this._form.style.display&&(L.DomUtil.removeClass(this._titleContainer,"title-hidden"),L.DomUtil.removeClass(this._titleContainer,"title-error"),L.DomUtil.removeClass(this._titleContainer,"title-success"),this._titleContainer.innerHTML=this._map.options.text.loadJson)},_onMouseOut(){L.DomUtil.addClass(this._titleContainer,"title-hidden")}})},function(e,t,i){"use strict";t.a=L.Control.extend({options:{position:"msgcenter",defaultMsg:null},initialize(e){L.Util.setOptions(this,e)},_titleContainer:null,onAdd(e){var t=L.DomUtil.create("div","leaflet-bottom"),i=L.DomUtil.create("div","leaflet-msg-editor");return e._controlCorners.msgcenter=t,e._controlContainer.appendChild(t),setTimeout(()=>{this._setContainer(i,e),e.fire("msgHelperAdded",{control:this}),this._changePos()},1e3),e.getBtnControl=(()=>this),this._bindEvents(e),i},_changePos(){var e=this._map._controlCorners.msgcenter;if(e&&e.children.length){var t=e.children[0].children[0];if(!t)return;var i=t.clientWidth;i&&(e.style.left=(this._map._container.clientWidth-i)/2+"px")}},_bindEvents(){setTimeout(()=>{window.addEventListener("resize",()=>{this._changePos()})},1)},_setContainer(e){this._titleContainer=L.DomUtil.create("div","leaflet-msg-container title-hidden"),this._titlePosContainer=L.DomUtil.create("div","leaflet-msg-container title-hidden"),e.appendChild(this._titleContainer),document.body.appendChild(this._titlePosContainer),null!==this.options.defaultMsg&&(L.DomUtil.removeClass(this._titleContainer,"title-hidden"),this._titleContainer.innerHTML=this.options.defaultMsg)},getOffset(e){var t=0,i=0;if(!this._map.isFullscreen||!this._map.isFullscreen())for(;e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)t+=e.offsetLeft,i+=e.offsetTop,e=e.offsetParent;return{y:i,x:t}},msg(e,t,i){if(e&&this._titlePosContainer)if(i){var s;L.DomUtil.removeClass(this._titlePosContainer,"title-hidden"),L.DomUtil.removeClass(this._titlePosContainer,"title-error"),L.DomUtil.removeClass(this._titlePosContainer,"title-success"),this._titlePosContainer.innerHTML=e;var o=this.getOffset(this._map._container);i instanceof L.Point?(s=i,s=this._map.layerPointToContainerPoint(s)):s=this._map.latLngToContainerPoint(i.getLatLng()),s.x+=o.x,s.y+=o.y,this._titlePosContainer.style.top=s.y-8+"px",this._titlePosContainer.style.left=s.x+10+"px",t&&L.DomUtil.addClass(this._titlePosContainer,"title-"+t)}else L.DomUtil.removeClass(this._titleContainer,"title-hidden"),L.DomUtil.removeClass(this._titleContainer,"title-error"),L.DomUtil.removeClass(this._titleContainer,"title-success"),this._titleContainer.innerHTML=e,t&&L.DomUtil.addClass(this._titleContainer,"title-"+t),this._changePos()},hide(){this._titleContainer&&L.DomUtil.addClass(this._titleContainer,"title-hidden"),this._titlePosContainer&&L.DomUtil.addClass(this._titlePosContainer,"title-hidden")},getBtnContainer(){return this._map._controlCorners.msgcenter},getBtnAt(e){return this.getBtnContainer().child[e]},disableBtn(e){L.DomUtil.addClass(this.getBtnAt(e),"disabled")},enableBtn(e){L.DomUtil.removeClass(this.getBtnAt(e),"disabled")}})},function(e,t,i){"use strict";t.a=function(e){var t=e.options.controls;if((!t||t.zoom)&&e.zoomControl){var i=e.zoomControl._container;e._titleZoomContainer=L.DomUtil.create("div","btn-leaflet-msg-container zoom title-hidden"),e._titleZoomContainer.innerHTML=e.options.text.zoom,i.appendChild(e._titleZoomContainer);L.DomEvent.addListener(i,"mouseover",()=>{L.DomUtil.removeClass(e._titleZoomContainer,"title-hidden")},this),L.DomEvent.addListener(i,"mouseout",()=>{L.DomUtil.addClass(e._titleZoomContainer,"title-hidden")},this),e.zoomControl._zoomInButton.title="",e.zoomControl._zoomOutButton.title=""}}},function(e,t,i){"use strict";t.a=function(e){if(e.options.fullscreenControl){var t=e.fullscreenControl.link;t.title="",L.DomUtil.addClass(t,"full-screen"),e.off("fullscreenchange"),e.on("fullscreenchange",()=>{L.DomUtil.addClass(e._titleFullScreenContainer,"title-hidden"),e.isFullscreen()?e._titleFullScreenContainer.innerHTML=e.options.text.hideFullScreen:e._titleFullScreenContainer.innerHTML=e.options.text.showFullScreen},this);var i=e.fullscreenControl._container;e._titleFullScreenContainer=L.DomUtil.create("div","btn-leaflet-msg-container title-hidden"),e._titleFullScreenContainer.innerHTML=e.options.text.showFullScreen,i.appendChild(e._titleFullScreenContainer);L.DomEvent.addListener(i,"mouseover",()=>{L.DomUtil.removeClass(e._titleFullScreenContainer,"title-hidden")},this),L.DomEvent.addListener(i,"mouseout",()=>{L.DomUtil.addClass(e._titleFullScreenContainer,"title-hidden")},this)}}},function(e,t,i){"use strict";var s=i(23),o=i(3),r=i(24),n=i(5),a=i(6),l=i(25);i(26);t.a={viewGroup:null,editGroup:null,editPolygon:null,editMarkersGroup:null,editLineGroup:null,dashedEditLineGroup:null,editHoleMarkersGroup:null,setLayers(){this.viewGroup=new s.a([]),this.editGroup=new l.a([]),this.editPolygon=new o.a([]),this.editMarkersGroup=new L.MarkerGroup([]),this.editLineGroup=new n.a([]),this.dashedEditLineGroup=new a.a([]),this.editHoleMarkersGroup=new r.a([])}}},function(e,t,i){"use strict";t.a=L.MultiPolygon.extend({initialize(e,t){L.MultiPolygon.prototype.initialize.call(this,e,t),this.on("layeradd",e=>{var t=this._map.options.style.view;e.target.setStyle($.extend({opacity:.7,fillOpacity:.35,color:"#00ABFF"},t)),this._map._moveEPolygonOnTop()})},isEmpty(){return 0===this.getLayers().length},onAdd(e){L.MultiPolygon.prototype.onAdd.call(this,e),this.on("mousemove",t=>{var i=e.getEMarkersGroup();i.isEmpty()?e.fire("editor:view_polygon_mousemove",{layerPoint:t.layerPoint}):i.getFirst()._hasFirstIcon()||e.fire("editor:view_polygon_mousemove",{layerPoint:t.layerPoint})}),this.on("mouseout",()=>{var t=e.getEMarkersGroup();t.isEmpty()?e.fire("editor:view_polygon_mouseout"):t.getFirst()._hasFirstIcon()||e.fire("editor:view_polygon_mouseout")})},onClick(e){var t,i=this._map,s=i.getSelectedMGroup();(t=i.getEMarkersGroup()).getFirst()&&t.getFirst()._hasFirstIcon()&&!t.isEmpty()||s&&s.getFirst()&&s.getFirst()._hasFirstIcon()&&!s.isEmpty()?((t=i.getEMarkersGroup()).set(e.latlng),i._convertToEdit(t)):(i._getSelectedVLayer()?i._setEPolygon_To_VGroup():i._addEPolygon_To_VGroup(),i.clear(),i.mode("draw"),i._hideSelectedVLayer(e.layer),t.restore(e.layer),i._convertToEdit(t),t.select())},onRemove(e){this.off("mouseover"),this.off("mouseout"),e.off("editor:view_polygon_mousemove"),e.off("editor:view_polygon_mouseout")}})},function(e,t,i){"use strict";t.a=L.FeatureGroup.extend({_selected:!1,_lastHole:void 0,_lastHoleToDraw:void 0,addHoleGroup(){return this._lastHole=new L.MarkerGroup,this._lastHole._isHole=!0,this._lastHole.addTo(this),this._lastHole.position=this.getLength()-1,this._lastHoleToDraw=this._lastHole,this._lastHole},getLength(){return this.getLayers().length},resetLastHole(){this._lastHole=void 0},setLastHole(e){this._lastHole=e},getLastHole(){return this._lastHole},remove(){this.eachLayer(e=>{for(;e.getLayers().length;)e.removeMarkerAt(0)})},repos(e){this.eachLayer(t=>{t.position>=e&&(t.position-=1)})},resetSelection(){this.eachLayer(e=>{e.getLayers()._each(e=>{e.unSelectIconInGroup()})}),this._selected=!1}})},function(e,t,i){"use strict";t.a=L.FeatureGroup.extend({isEmpty(){return 0===this.getLayers().length}})},function(e,t,i){"use strict";var s=i(27),o=i(8),r=(i(5),i(6)),n=i(9),a=i(0);L.Util.extend(L.LineUtil,{segmentsIntersect(e,t,i,s){return this._checkCounterclockwise(e,i,s)!==this._checkCounterclockwise(t,i,s)&&this._checkCounterclockwise(e,t,i)!==this._checkCounterclockwise(e,t,s)},_checkCounterclockwise:(e,t,i)=>(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)});let l=!1;L.MarkerGroup=s.a.extend({_isHole:!1,_editLineGroup:void 0,_position:void 0,dashedEditLineGroup:new r.a([]),options:{mIcon:void 0,mHoverIcon:void 0},initialize(e){L.LayerGroup.prototype.initialize.call(this,e),this._markers=[]},onAdd(e){this._map=e,this.dashedEditLineGroup.addTo(e)},_updateDELine(e){var t=this.getDELine();return this._firstMarker&&t.update(e),t},_addMarker(e){this.set(e),this.getDELine().addLatLng(e),this._map._convertToEdit(this)},getDELine(){return this.dashedEditLineGroup._map||this.dashedEditLineGroup.addTo(this._map),this.dashedEditLineGroup},_setHoverIcon(){var e=this._map;void 0!==e._oldSelectedMarker&&e._oldSelectedMarker._resetIcon(this.options.mIcon),e._selectedMarker._setHoverIcon(this.options.mHoverIcon)},_sortByPosition(){if(!this._isHole){var e=this.getLayers(),t=[],i=[];(e=e.sort(function(e,t){return e._leaflet_id-t._leaflet_id})).forEach(e=>{t.push(e._leaflet_id),i.push(e.__position)}),Object(n.a)(this._layers,t)}},updateStyle(){for(var e=this.getLayers(),t=0;t<e.length;t++){var i=e[t];i._resetIcon(this.options.mIcon),i===this._map._selectedMarker&&this._setHoverIcon()}},setSelected(e){var t=this._map;if(t.__polygonEdgesIntersected&&this.hasFirstMarker())return t._selectedMarker=this.getLast(),void(t._oldSelectedMarker=t._selectedMarker);t._oldSelectedMarker=t._selectedMarker,t._selectedMarker=e},resetSelected(){var e=this._map;e._selectedMarker&&(e._selectedMarker._resetIcon(this.options.mIcon),e._selectedMarker=void 0)},getSelected(){return this._map._selectedMarker},_setFirst(e){this._firstMarker=e,this._firstMarker._setFirstIcon()},getFirst(){return this._firstMarker},getLast(){if(this.hasFirstMarker()){var e=this.getLayers();return e[e.length-1]}},hasFirstMarker(){return this.getFirst()&&this.getFirst()._hasFirstIcon()},convertToLatLngs(){var e=[];return this.eachLayer(function(t){t.isMiddle()||e.push(t.getLatLng())}),e},restore(e){this.setAll(e._latlngs),this.setAllHoles(e._holes)},_add(e,t,i={}){this._map.isMode("draw")&&(this._firstMarker||(i.icon=a.b));var s=this.addMarker(e,t,i);return this.getDELine().addLatLng(e),l=!0,this.getFirst()._hasFirstIcon()?(this._map.on("mousemove",e=>{l||this._updateDELine(e.latlng)}),l=!1):this.getDELine().clear(),s._mGroup.getLayers().length>2&&s._mGroup._firstMarker._hasFirstIcon()&&s===s._mGroup._lastMarker&&this._map.fire("editor:last_marker_dblclick_mouseover",{marker:s}),s},_closestNotMiddleMarker:(e,t,i)=>e[t].isMiddle()?e[t+i]:e[t],_setPrevNext(e,t){var i=this.getLayers(),s=i.length-1;return 1===t?(e._prev=this._closestNotMiddleMarker(i,t-1,-1),e._next=this._closestNotMiddleMarker(i,2,1)):t===s?(e._prev=this._closestNotMiddleMarker(i,s-1,-1),e._next=this._closestNotMiddleMarker(i,0,1)):(null==e._middlePrev&&(e._prev=i[t-1]),null==e._middleNext&&(e._next=i[t+1])),e},setMiddleMarker(e){this.addMarker(e,null,{icon:a.f})},setMiddleMarkers(e){this.setMiddleMarker(e),this.setMiddleMarker(e+2)},set(e,t,i){if(!this.hasIntersection(e))return this._map.edgesIntersected(!1),this._add(e,t,i)},setMiddle(e,t,i){t=t<0?0:t;var s=this.set(e,t,i);return s._setMiddleIcon(),s},setAll(e){e.forEach((e,t)=>{this.set(e,t)}),this.getFirst().fire("click")},setAllHoles(e){e.forEach(e=>{var t=this._map.getEHMarkersGroup().addHoleGroup();e._each((e,i)=>{t.set(e,i)}),t.getFirst().fire("click")})},setHoleMarker(e,t={isHoleMarker:!0,holePosition:{}}){var i=new o.a(this,e,t||{});return i.addTo(this),this._map.isMode("draw")&&1===this.getLayers().length&&this._setFirst(i),i},removeHole(){var e=this._map;this.clearLayers(),e.getEPolygon().getHoles().splice(this._position,1),e.getEPolygon().redraw(),e.getEHMarkersGroup().clearLayers();for(var t=e.getEPolygon().getHoles(),i=0;i<t.length;i++)e._setEHMarkerGroup(t[i])},removeSelected(){var e=this.getSelected(),t=this.getLayers(),i=e.getLatLng(),s=this._map;if(t.length>0&&(this.removeLayer(e),s.fire("editor:delete_marker",{latlng:i})),t=this.getLayers(),this._isHole){if(s.isMode("edit")){if(t.length<4)this.removeHole();else{e.options.holePosition;s.getEPolygon().getHole(this._position).splice(e.__position,1),s.getEPolygon().redraw()}var o=0;this.eachLayer(e=>{e.options.holePosition={hGroup:this._position,hMarker:o++}})}}else s.isMode("edit")&&t.length<3&&(this.clearLayers(),s.getEPolygon().clear());var r=0;this.eachLayer(e=>{e.options.title=r,e.__position=r++})},getPointsForIntersection(e){var t=this._map;this._originalPoints=[];var i=(e?e.getLayers():this.getLayers()).filter(e=>!e.isMiddle());if(this._originalPoints=[],i._each(e=>{var t=e.getLatLng();this._originalPoints.push(new L.Point(t.lng,t.lat))}),!e)if(t._selectedMarker===i[0])this._originalPoints=this._originalPoints.slice(1);else if(t._selectedMarker===i[i.length-1])this._originalPoints.splice(-1);else for(var s=[],o=1;o<i.length;o++)if(t._selectedMarker===i[o]){s=this._originalPoints.splice(o+1),this._originalPoints=s.concat(this._originalPoints),this._originalPoints.splice(-1);break}return this._originalPoints},_bindLineEvents:void 0,_hasIntersection(e,t,i){var s=e?e.length:0,o=e?e[s-1]:null,r=s-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(o,t,r,i)},_hasIntersectionWithHole(e,t,i){e&&e.length;return!this._tooFewPointsForIntersection(1)&&this._lineHoleSegmentsIntersectsRange(i,t)},hasIntersection(e,t){var i=this._map;if(i.options.allowIntersection)return!1;var s=new L.Point(e.lng,e.lat),o=this.getPointsForIntersection(),r=this._hasIntersection(o,s,t),n=!1,a=this.getFirst();a&&!a._hasFirstIcon()&&(o=this.getPointsForIntersection().reverse(),n=this._hasIntersection(o,s,t)),i.edgesIntersected(r||n);var l=i.edgesIntersected();return l},hasIntersectionWithHole(e,t){if(this._map.options.allowIntersection)return!1;var i=new L.Point(e[0].lng,e[0].lat),s=new L.Point(e[1].lng,e[1].lat),o=this.getPointsForIntersection(t),r=this._hasIntersectionWithHole(o,i,s);o=this.getPointsForIntersection(t).reverse(),s=new L.Point(e[2].lng,e[2].lat);var n=this._hasIntersectionWithHole(o,i,s);this._map.edgesIntersected(r||n);var a=this._map.edgesIntersected();return a},_tooFewPointsForIntersection(e){var t=this._originalPoints,i=t?t.length:0;return i+=e||0,!this._originalPoints||i<=3},_lineHoleSegmentsIntersectsRange(e,t){for(var i,s,o=this._originalPoints,r=o.length-1;r>0;r--)if(i=o[r-1],s=o[r],L.LineUtil.segmentsIntersect(e,t,i,s))return!0;return!1},_lineSegmentsIntersectsRange(e,t,i,s){for(var o,r,n=this._originalPoints,a=s?1:0,l=i;l>a;l--)if(o=n[l-1],r=n[l],L.LineUtil.segmentsIntersect(e,t,o,r))return!0;return!1},_isMarkerInPolygon(e){for(var t=0,i=this.getLayers(),s=i.length,o=e.lng,r=e.lat,n=!1,a=0;a<s;a++){++t==s&&(t=0);var l=i[a].getLatLng(),h=i[t].getLatLng();(l.lat<r&&h.lat>=r||h.lat<r&&l.lat>=r)&&l.lng+(r-l.lat)/(h.lat-l.lat)*(h.lng-l.lng)<o&&(n=!n)}return n}})},function(e,t,i){"use strict";var s=i(8);i(9);t.a=L.Class.extend({includes:L.Mixin.Events,_selected:!1,_lastMarker:void 0,_firstMarker:void 0,_positionHash:void 0,_lastPosition:0,_markers:[],onAdd(e){this._map=e,this.clearLayers()},onRemove(e){this.clearLayers()},clearLayers(){this._markers.forEach(e=>{this._map.removeLayer(e)}),this._markers=[]},addTo(e){e.addLayer(this)},addLayer(e){this._map.addLayer(e),this._markers.push(e),null!=e.position&&this._markers.move(this._markers.length-1,e.position),e.position=null!=e.position?e.position:this._markers.length-1},remove(){var e=this.getLayers();e._each(e=>{for(;this.getLayers().length;)this.removeMarker(e)});var t=this._map;this._isHole?t.fire("editor:polygon:hole_deleted"):(t.getVGroup().removeLayer(t._getSelectedVLayer()),t.fire("editor:polygon:deleted"))},removeLayer(e){var t=e.position;this._map.removeLayer(e),this._markers.splice(t,1)},getLayers(){return this._markers},eachLayer(e){this._markers.forEach(e)},markerAt(e){var t=this._markers[e];return e<0?this.firstMarker():(void 0===t&&(t=this.lastMarker()),t)},firstMarker(){return this._markers[0]},lastMarker(){var e=this._markers;return e[e.length-1]},removeMarker(e){var t=!e.isMiddle(),i=e._prev,s=e._next,o=e._next._next;this.removeMarkerAt(e.position),this.removeMarkerAt(i.position),this.removeMarkerAt(s.position);var r=this._map;this.getLayers().length>0?(this.setMiddleMarker(o.position),t&&r.fire("editor:delete_marker",{marker:e})):(this._isHole?(r.removeLayer(this),r.fire("editor:delete_hole",{marker:e})):(r.removePolygon(r.getEPolygon()),r.fire("editor:delete_polygon")),r.fire("editor:marker_group_clear"))},removeMarkerAt(e){var t;if(0!==this.getLayers().length&&"number"==typeof e){t=this.markerAt(e);var i=!1,s=this._markers;if(s.forEach(e=>{i&&(e.position=0===e.position?0:e.position-1),e===t&&(t._prev._next=t._next,t._next._prev=t._prev,i=!0)}),this.removeLayer(t),s.length<5&&(this.clear(),!this._isHole)){var o=this._map;o.getEPolygon().clear(),o.getVGroup().removeLayer(o._getSelectedVLayer())}}},addMarker(e,t,i){if("number"==typeof e){t=this.markerAt(e).position,this._recalcPositions(t);var o=t-1<0?this.lastMarker():this.markerAt(t-1),r=this.markerAt(-1==t?1:t);e=this._getMiddleLatLng(o,r)}0===this.getLayers().length&&(i.draggable=!1),this.getFirst()&&(i.draggable=!this.getFirst()._hasFirstIcon());var n=new s.a(this,e,i);return this._firstMarker||(this._firstMarker=n,this._lastMarker=n),void 0!==t&&(n.position=t),this.addLayer(n),n.position=void 0!==n.position?n.position:this._lastPosition++,n._prev=this._lastMarker,this._firstMarker._prev=n,n._prev&&(this._lastMarker._next=n,n._next=this._firstMarker),void 0===t&&(this._lastMarker=n),void 0!==t&&this._recalcRelations(n),n.isMiddle()||this._map.fire("editor:add_marker",{marker:n}),n},clear(){var e=this._ids();this.clearLayers(),e.forEach(e=>{this._deleteEvents(e)}),this._lastPosition=0,this._firstMarker=void 0},_deleteEvents(e){delete this._map._leaflet_events.viewreset_idx[e],delete this._map._leaflet_events.zoomanim_idx[e]},_getMiddleLatLng(e,t){var i=this._map,s=i.project(e.getLatLng()),o=i.project(t.getLatLng());return i.unproject(s._add(o)._divideBy(2))},_recalcPositions(e){var t=this._markers,i=!1;t.forEach((t,s)=>{e===s&&(i=!0),i&&(this._markers[s].position+=1)})},_recalcRelations(){var e=this._markers;e.forEach((t,i)=>{t._prev=this.markerAt(i-1),t._next=this.markerAt(i+1),0===i&&(t._prev=this.lastMarker(),t._next=this.markerAt(1)),i===e.length-1&&(t._prev=this.markerAt(i-1),t._next=this.markerAt(0))})},_ids(){var e=[];for(let t in this._layers)e.push(t);return e.sort((e,t)=>e-t),e},select(){if(this.isEmpty())this._map._selectedMGroup=null;else{var e=this._map;this._isHole?(e.getEHMarkersGroup().resetSelection(),e.getEMarkersGroup().resetSelection(),e.getEHMarkersGroup().setLastHole(this)):(e.getEHMarkersGroup().resetSelection(),e.getEHMarkersGroup().resetLastHole()),this.getLayers()._each(e=>{e.selectIconInGroup()}),this._selected=!0,this._map._selectedMGroup=this,this._map.fire("editor:marker_group_select")}},isEmpty(){return 0===this.getLayers().length},resetSelection(){this.getLayers()._each(e=>{e.unSelectIconInGroup()}),this._selected=!1}})},function(e,t,i){"use strict";Array.prototype.move=function(e,t){this.splice(t,0,this.splice(e,1)[0])},Array.prototype._each=function(e){for(var t=this.length,i=0;i<t;i++)e.call(this,this[i],i)};Array},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(10);window.LeafletEditor=Object(s.a)()}]);